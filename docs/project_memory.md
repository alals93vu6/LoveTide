# 🧠 專案記憶檔案 (Project Memory)

> 專為 Claude 設計的專案記憶檔案，每次開啟新對話時請先閱讀此檔案以快速了解專案現況。

---

## 🎯 專案基本資訊

### 📋 專案名稱
**LoveTide** - 戀愛養成遊戲

#### 🎮 遊戲實機畫面
- **實機截圖位置**: `docs/實機畫面/` 資料夾
- **主要展示**: 完整的遊戲迴圈流程
- **涵蓋系統**: 主選單、養成模式、劇情對話、角色互動、設定系統
- **技術展示**: Spine角色動畫 + 靜態立繪混合架構

### 📂 專案結構
```
E:\GitHub\LoveTide/
├─ docs/                    👈 文件資料夾（你現在在這裡）
│  ├─ claude_write_guide.md 👈 文件撰寫規範
│  ├─ project_memory.md     👈 專案記憶檔案（本檔案）
│  ├─ 實機畫面/             👈 遊戲截圖展示（重要！）
│  ├─ GameMechanics/        👈 遊戲機制說明
│  ├─ Architecture/         👈 模組架構說明
│  ├─ CodeModules/          👈 程式模組說明
│  └─ ProjectLogs/          👈 工作日誌記錄
├─ LoveTide/                👈 Unity 主專案
│  ├─ Assets/Scripts/       👈 核心程式碼
│  ├─ Assets/Scenes/        👈 遊戲場景
│  └─ Assets/Resources/     👈 遊戲資源
└─ Other/                   👈 額外資源
```

### 🎮 專案特色
- **戀愛養成遊戲** - 多角色互動系統
- **Unity 引擎開發** - C# 程式語言
- **模組化設計** - 高度可擴展架構
- **JSON 驅動** - 內容管理系統
- **Spine + 靜態混合** - 1位主角Spine動畫 + 其他靜態立繪
- **多模式遊戲** - 劇情模式、養成模式、成人內容模式
- **小團隊開發** - 兩人團隊，資源優化設計

---

## 🔄 當前開發狀態

### 📊 進度摘要
- **狀態**: 🎯 **重製架構設計完成** - Canvas + SkeletonGraphic技術方案確定
- **遊戲狀態**: 重製操作手冊完整，現有腳本移植策略明確
- **文檔狀態**: 完整的Canvas分層架構和腳本移植指南已建立
- **階段**: 🚀 **準備進入實作階段** - 從設計轉向具體Canvas系統建置

### 🎯 當前任務
1. ✅ 完善專案文件結構
2. ✅ 更新架構設計文件
3. ✅ 建立清晰的開發流程
4. ✅ 完善小遊戲文檔 (釣魚 + 餐廳)
5. ✅ **新版劇情系統設計完成** (2025-01-17)
6. ✅ **GamePlay場景翻新計劃完成** (2025-08-17)
7. ✅ **重製操作手冊完成** (2025-08-17)
8. ✅ **腳本移植策略確定** (2025-08-19)
9. ✅ **Canvas + SkeletonGraphic架構確認** (2025-08-19)
10. ✅ **現有Yuka腳本分析完成** (2025-08-19)
11. 🚀 **準備開始實作**: Canvas分層架構重構
12. 🔄 創建7層Canvas分層系統
13. 🔄 移植SmallYuka到DynamicCharacterCanvas
14. 🔄 實作FullYuka角色對話系統
15. 🔄 建立全新互動系統腳本
16. 🔄 整合現有腳本到新架構
17. 🔄 補充實機驗證截圖

---

## 📚 閱讀建議

### 🔍 新 Claude 上手步驟
1. **先讀本檔案** 了解專案概況
2. **查看實機畫面** 閱讀 `docs/實機畫面/` 了解遊戲實際狀況
3. **閱讀 `claude_write_guide.md`** 了解文件撰寫規範
4. **瀏覽 `README.md`** 了解整體專案架構
5. **依序閱讀**:
   - `docs/GameMechanics/` - 遊戲機制
   - `docs/Architecture/` - 模組架構
   - `docs/CodeModules/` - 程式模組
   - `docs/ProjectLogs/` - 最新工作日誌

### 🚨 重要提醒
- 修改程式碼前，先確認架構文件
- 遵循現有的模組化設計原則
- 優先使用 JSON 管理遊戲內容
- 保持高模組化、低耦合的設計

---

## 🛠 開發環境資訊

### 📁 主要工作目錄
```
工作目錄: ?:\GitHub\LoveTide
專案類型: Unity 遊戲專案
語言: C# (Unity)
```

### 🔧 開發工具
- Unity 引擎
- Visual Studio / VSCode
- Git 版本控制

---

## 💼 最近工作重點

### 🎯 核心任務 (2025-01-17 重大更新)
- ✅ 建立JSON驅動存檔系統架構
- ✅ 完善雙重對話系統文檔 (養成模式 + 劇情模式)
- ✅ 設計未來JSON驅動劇情管理系統
- ✅ **已完成**: 重組架構文檔資料夾結構
  - 分離養成模式 (NurturingMode) 和劇情模式 (StoryMode) 文檔
  - 建立共用系統 (SharedSystems) 文檔分類
  - 更新README.md交叉引用系統
- ✅ **新增**: 貓咪互動系統架構
  - 釣魚🎣 → 餵食🐟 → 嚕貓😽 → 特殊劇情🎭 連動機制
  - 簡化魚類分級 (一般魚 vs 稀有魚)
  - 5條稀有魚觸發一次性特殊劇情設計
- ✅ **完成**: 小遊戲系統設計與平衡
  - 釣魚機制文檔 (基於實際程式碼分析)
  - 餐廳管理系統文檔 (複雜經營玩法)
  - 遊戲經濟平衡調整 (釣魚悠閒 vs 餐廳高強度)
  - 完整程式架構文檔
- ✅ **重大突破**: 新版劇情系統完整架構設計 (2025-01-17)
  - 🎭 章節配置系統：解決角色維護困難問題
  - 🎵 語音播放系統：完整的語音播放與索引管理
  - 🔄 角色映射系統：廣義角色類型動態映射
  - 📊 更新Main_01.json：protagonist + Support1 + 語音BOOL
  - 📋 完整技術文檔：`docs/Architecture/CoreSystems/新版劇情系統完整架構.md`
- 🔥 **重大工程啟動**: GamePlay場景全面重製計劃 (2025-08-17)
  - 🆕 **全新腳本系統**: 不擴展現有系統，完全重新開發
  - 🎨 **Canvas分層架構**: 7層Canvas互動系統 (動態角色、靜態物件分離)
  - 🔄 **智能狀態管理**: 全新的遊戲狀態控制系統
  - 📱 **響應式UI設計**: 多解析度適配與視覺反饋系統
  - 🔒 **安全策略**: 舊場景備份保護 (GamePlayScene_old.unity)
  - 📊 **漸進式遷移**: 新舊系統分離，可獨立開發和測試
- 📋 **重製操作手冊完成**: 完整的物件配置與腳本對應指南 (2025-08-17)
  - 🏗️ **完整結構總預覽**: 三層架構 (WorldSpace + CoreManagers + UISystem)
  - 🎯 **詳細腳本配置**: 每個物件的具體腳本和組件配置
  - 📋 **階段化實施計劃**: 4個明確階段的操作步驟
  - 🔧 **引用綁定檢查清單**: 防止配置遺漏的完整檢查表
  - ⚠️ **安全措施與測試**: 回滾策略和功能驗證指南
- 🎭 **Canvas + SkeletonGraphic架構確認** (2025-08-19)
  - ✨ **技術方案確定**: Yuka角色採用SkeletonGraphic + Canvas架構
  - 🎪 **雙角色系統**: Q版小Yuka(簡化4動畫) + 完整Yuka立繪(四軌道表情)
  - 🔧 **腳本移植策略**: 85%現有代碼可重用，僅需修改輸入和座標系統
  - 📋 **具體移植指南**: CharacterMovement.cs等關鍵腳本的詳細修改要點
  - 💡 **技術統一**: 移除透明Button跟隨的複雜實現，改用UI直接互動
  - 🎯 **兩大場景×兩種模式**: 餐廳/宿舍場景 × Q版全景/角色對話模式設計

### 🎭 重要架構決策
- **存檔系統**: JSON主導 + PlayerPrefs備援的雙重保險機制
- **劇情觸發**: 保持原有的"條件檢查→進度+1→播劇情"邏輯，但升級為JSON驅動
- **多角色支援**: 未來需考慮多女配角系統，需要角色偵測機制

### ⚠️ 注意事項
- 多角色系統擴展性考量 - 不僅是女主角，還有女配角的劇情分支
- JSON數據結構需要兼容現有PlayerPrefs系統
- 保持"原始人"的簡潔設計理念 - 避免過度工程
- 🚨 **演員系統大改動** - 角色偵測和演員控制將有重大架構調整
- 😽 **嚕貓時間消耗待商榷** - 是否消耗遊戲時間需要根據實際體驗決定
- 🔥 **重製工程風險控制** - 新舊系統完全分離，確保回滾安全性
- 🎮 **開發週期長** - 全新腳本系統將是一個長期工程項目
- 🎭 **腳本移植注意**: 座標系統(世界→UI)和輸入系統(Physics→UI事件)轉換
- 🖼️ **背景分層處理**: BackgroundCanvas需要透明佔位圖維持Canvas完整性

---

## 🎮 遊戲系統概覽

### 🎭 核心遊戲模式

#### 📜 劇情模式
- **特色**: 靜態立繪 + CG畫面
- **互動**: 對話文字進行、選擇分支
- **角色**: 使用 ActorManagerDrama 控制立繪表情
- **展示**: 見 `實機畫面/劇情模式*.png`

#### 💖 養成模式
- **特色**: 酒吧場景 + Yuka Spine動畫
- **互動**: 點擊角色、對話、外出系統
- **角色**: 1位主角(Spine) + 多位配角(靜態)
- **展示**: 見 `實機畫面/養成模式*.png`

#### ⚙️ 系統設定
- **功能**: BGM/音效/語音音量控制
- **界面**: 視窗模式、語言切換
- **存檔**: 存檔/讀檔系統
- **展示**: 見 `實機畫面/設定.png`

### 🎯 技術架構特點

#### 🎨 演員控制系統
- **Yuka (主角)**: Spine動畫，四軌道表情控制(眉毛、眼睛、嘴巴、臉部)
- **其他角色**: 靜態立繪，圖片切換系統
- **統一接口**: 所有角色使用相同的 `IActorController` 接口
- **資源優化**: 5位女角使用統一系統，僅修改前綴名稱

#### 📦 數據流系統
- **JSON 驅動**: 對話、設定、角色數據全部使用 JSON
- **GameManager 中心化**: 所有系統經由 GameManagerTest 統一調度
- **EventBus 通訊**: 模組間使用事件系統通訊，保持低耦合

#### 🛠️ 開發理念
- **小團隊優化**: 兩人團隊，資源有限，重視實用性
- **核心功能專注**: 主要功能是表情系統和互動對話
- **模組化設計**: 高度可擴展，但保持簡潔
- **成人內容重點**: 此模式功能較為豐富，其他模式相對簡潔

---

## 📞 協助指南

### 🤝 如何與 Claude 協作
1. **明確需求**: 詳細描述要實現的功能
2. **提供上下文**: 指出相關的模組或系統
3. **遵循規範**: 按照 `claude_write_guide.md` 進行文件撰寫
4. **更新記錄**: 完成任務後更新 `docs/ProjectLogs/`

### 📋 常見任務類型
- **新功能開發** - 新增遊戲機制或角色互動
- **程式碼重構** - 模組化和性能優化
- **文件更新** - 保持文檔與程式碼同步
- **架構優化** - 系統設計和效能提升
- **問題排除** - Bug修復和系統調試
- **實機驗證** - 查看截圖驗證功能實現

---

## 🔗 重要連結

### 📑 關鍵文件
- `docs/claude_write_guide.md` - 文件撰寫規範
- `docs/實機畫面/` - 遊戲實際截圖展示 📷
- `docs/Architecture/演員控制架構.md` - 核心角色系統
- `docs/Architecture/數據流架構.md` - 數據管理系統
- `docs/GameMechanics/養成互動系統.md` - 互動機制
- `README.md` - 專案總覽
- `docs/ProjectLogs/` - 最新工作進度

### 🎯 建議工作流程
1. **先查看實機畫面** - 了解遊戲當前狀態
2. **閱讀相關文檔** - 根據任務查看架構文件
3. **查看程式碼** - 了解實際實現方式
4. **進行開發** - 修改或新增功能
5. **更新文件** - 保持文檔同步
6. **驗證功能** - 確認與實機畫面一致
7. **記錄日誌** - 更新 ProjectLogs

---

## 🚀 快速開始

當你看到這個檔案時，表示你是一個全新的 Claude 實例。請：

1. ✅ 先完整閱讀此檔案
2. ✅ 查看 `docs/ProjectLogs/` 最新日誌了解當前進度
3. ✅ 詢問使用者當前需要處理的具體任務
4. ✅ 根據任務需求閱讀相關模組文件
5. ✅ 開始協助開發工作

---

**最後更新**: 2025-08-19
**版本**: 4.2 🎭 **Canvas架構技術確認版**
**維護者**: 開發團隊 + Claude AI
**重要更新**: 
- ✅ 新增JSON驅動存檔系統架構
- ✅ 完善雙重對話系統文檔結構
- ✅ 完成架構文檔重組工程 (養成模式/劇情模式分離)
- ✅ 新增貓咪互動系統架構 (釣魚連動機制)
- ✅ 完善小遊戲系統架構 (釣魚+餐廳完整設計)
- ✅ 制定釣魚系統程式實作計劃
- 🎭 **重大更新**: 新版劇情系統完整架構設計完成
  - 章節配置系統 + 角色映射系統 + 語音播放系統
  - 解決角色維護困難和語音播放缺失問題
  - 提供完整的5層架構設計和實作指南
  - 更新Main_01.json為新格式 (protagonist + Support1 + 語音BOOL)
- 🔥 **史詩級更新**: GamePlay場景全面重製工程計劃 (2025-08-17)
  - 🆕 全新腳本系統開發 (非擴展，完全重新開發)
  - 🎨 7層Canvas分層互動架構設計
  - 🔄 智能狀態管理與響應式UI系統
  - 🔒 安全備份策略 (GamePlayScene_old.unity)
  - 📊 長期工程項目：預計進行數週的重大開發
- 📋 **操作手冊完成**: 重製工程實作指南 (2025-08-17→2025-08-19)
  - 🏗️ 完整場景結構總預覽圖 (WorldSpace + CoreManagers + UISystem)
  - 🎯 詳細的腳本配置方案 (每個物件的腳本和組件)
  - 📋 階段化實施計劃 (4階段操作步驟)
  - 🔧 引用綁定檢查清單 (防遺漏配置表)
  - ⚠️ 完整的安全措施和測試指南
- 🎭 **Canvas + SkeletonGraphic技術方案確認** (2025-08-19)
  - ✨ 技術架構最終確定：Yuka角色採用SkeletonGraphic + Canvas
  - 🎪 雙角色系統設計：Q版小Yuka(4動畫組合) + 完整Yuka立繪(四軌道表情)
  - 📋 現有腳本移植策略：85%代碼可重用，詳細修改指南完成
  - 💡 技術統一：移除複雜的透明Button跟隨，改用直接UI互動
  - 🛠️ 具體實作指導：CharacterMovement.cs等關鍵腳本修改要點
  - 🔧 背景系統優化：BackgroundCanvas透明佔位圖技術方案

> 💡 這個檔案會隨著專案進展持續更新，請定期檢查最新版本。