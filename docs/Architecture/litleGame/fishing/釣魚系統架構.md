# ğŸ£ é‡£é­šç³»çµ±ç¨‹å¼æ¶æ§‹

> åŸºæ–¼ç‹€æ…‹æ©Ÿæ¨¡å¼çš„é‡£é­šå°éŠæˆ²ç¨‹å¼æ¶æ§‹è¨­è¨ˆï¼Œæ•´åˆQTEç³»çµ±ã€é›£åº¦ç®¡ç†å’Œæ•¸æ“šæµæ§åˆ¶

---

## ğŸ§© ç³»çµ±æ¦‚è¦½

### ğŸ¯ æ ¸å¿ƒè¨­è¨ˆç†å¿µ
- **ç‹€æ…‹æ©Ÿé©…å‹•**: åŸºæ–¼ `IState` æ¥å£çš„æ¸…æ™°ç‹€æ…‹ç®¡ç†
- **æ¨¡çµ„åŒ–æ¶æ§‹**: å„å€‹ç³»çµ±çµ„ä»¶é«˜åº¦è§£è€¦ï¼Œä¾¿æ–¼ç¶­è­·å’Œæ“´å±•
- **æ•¸æ“šé©…å‹•**: é­šé¡é…ç½®ã€é›£åº¦åƒæ•¸å®Œå…¨ç”±æ•¸æ“šæ§åˆ¶
- **éŸ¿æ‡‰å¼è¨­è¨ˆ**: å³æ™‚çš„ç©å®¶è¼¸å…¥éŸ¿æ‡‰å’Œè¦–è¦ºå›é¥‹

### ğŸ“¦ ä¸»è¦æ¨¡çµ„çµ„æˆ
```
FishingSystem/
â”œâ”€â”€ Core/                    # æ ¸å¿ƒç³»çµ±
â”‚   â”œâ”€â”€ FishingManager       # ä¸»æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ StateSystem/         # ç‹€æ…‹æ©Ÿç³»çµ±
â”‚   â””â”€â”€ DataSystem/          # æ•¸æ“šç®¡ç†ç³»çµ±
â”œâ”€â”€ GamePlay/                # éŠæˆ²ç©æ³•
â”‚   â”œâ”€â”€ QTESystem/          # QTEæ“ä½œç³»çµ±
â”‚   â”œâ”€â”€ DifficultySystem/   # é›£åº¦è¨ˆç®—ç³»çµ±
â”‚   â””â”€â”€ FishSystem/         # é­šé¡ç®¡ç†ç³»çµ±
â”œâ”€â”€ UI/                      # ç”¨æˆ¶ç•Œé¢
â”‚   â”œâ”€â”€ StaminaDisplay/     # é«”åŠ›é¡¯ç¤º
â”‚   â”œâ”€â”€ DepthSelector/      # æ·±åº¦é¸æ“‡
â”‚   â””â”€â”€ SettlementUI/       # çµç®—ç•Œé¢
â””â”€â”€ Integration/             # ç³»çµ±æ•´åˆ
    â”œâ”€â”€ TimeSystem/         # æ™‚é–“ç®¡ç†
    â”œâ”€â”€ EconomySystem/      # ç¶“æ¿Ÿç³»çµ±
    â””â”€â”€ SaveSystem/         # å­˜æª”ç³»çµ±
```

---

## ğŸ—ï¸ æ ¸å¿ƒæ¶æ§‹è¨­è¨ˆ

### ğŸ® ä¸»æ§åˆ¶å™¨ (FishingManager)

```csharp
public class FishingManager : MonoBehaviour, IGameSystem
{
    [Header("ç³»çµ±ä¾è³´")]
    public StateManager stateManager;           // ç‹€æ…‹æ©Ÿç®¡ç†å™¨
    public QTESliderManager qteManager;         // QTEç³»çµ±ç®¡ç†å™¨
    public FishDataManager fishDataManager;    // é­šé¡æ•¸æ“šç®¡ç†å™¨
    public FishingUIManager uiManager;          // UIç®¡ç†å™¨
    
    [Header("ç•¶å‰ç‹€æ…‹")]
    public FishingGameState currentState;      // ç•¶å‰éŠæˆ²ç‹€æ…‹
    public FishSpecies currentFish;            // ç•¶å‰é­šé¡
    public int selectedDepthLevel;             // é¸ä¸­çš„æ°´æ·±ç­‰ç´š
    public int fishCaughtCount;                // ç•¶å‰å·²é‡£é­šæ•¸é‡
    public int remainingActionPoints;          // å‰©é¤˜è¡Œå‹•é»
    
    [Header("éŠæˆ²æ•¸å€¼")]
    public float maxStamina;                   // é­šé¡æœ€å¤§é«”åŠ›
    public float nowStamina;                   // ç•¶å‰é«”åŠ›
    public float rewards;                      // çå‹µä¿‚æ•¸ (0-1)
    public float loseTime;                     // å¤±æ•—ç´¯è¨ˆæ™‚é–“
    public float damageReduction;              // å‚·å®³æ¸›å…ä¿‚æ•¸
    
    // ç³»çµ±åˆå§‹åŒ–
    public void InitializeFishingSystem(int actionPoints)
    {
        remainingActionPoints = actionPoints;
        fishCaughtCount = 0;
        currentState = FishingGameState.Idle;
        stateManager.ChangeState(new Fishing_IdleState());
    }
    
    // ä¸»è¦éŠæˆ²å¾ªç’°
    void Update()
    {
        if (currentState == FishingGameState.Struggle)
        {
            ProcessQTELogic();
            UpdateStaminaSystem();
            CheckEndConditions();
        }
    }
    
    // QTEé‚è¼¯è™•ç†
    private void ProcessQTELogic()
    {
        if (qteManager.IsPlayerInTargetArea())
        {
            loseTime = 0f;
            rewards = Mathf.Lerp(rewards, 1, 0.0075f);
        }
        else
        {
            loseTime += Time.deltaTime;
            rewards = Mathf.Lerp(rewards, 0, 0.015f);
        }
    }
    
    // é«”åŠ›ç³»çµ±æ›´æ–°
    private void UpdateStaminaSystem()
    {
        float damage = CalculateDamage();
        nowStamina -= damage * Time.deltaTime;
        uiManager.UpdateStaminaDisplay(nowStamina, maxStamina);
    }
    
    // çµæŸæ¢ä»¶æª¢æŸ¥
    private void CheckEndConditions()
    {
        if (nowStamina <= 0)
        {
            stateManager.ChangeState(new Fishing_SettleState());
        }
        else if (remainingActionPoints <= 0)
        {
            ForceEndFishing();
        }
    }
}
```

### ğŸ”„ ç‹€æ…‹æ©Ÿç³»çµ±æ¶æ§‹

```csharp
// ç‹€æ…‹æ¥å£å®šç¾©
public interface IState
{
    void OnEnterState(object action);
    void OnStayState(object action);
    void OnExitState(object action);
}

// é‡£é­šç‹€æ…‹æšèˆ‰
public enum FishingGameState
{
    Idle,        // å¾…æ©Ÿç‹€æ…‹
    Struggle,    // æé¬¥ç‹€æ…‹
    QTE,         // QTEæš«åœç‹€æ…‹ (æ¸¬è©¦åŠŸèƒ½)
    Settlement   // çµç®—ç‹€æ…‹
}

// ç‹€æ…‹ç®¡ç†å™¨
public class FishingStateManager : MonoBehaviour
{
    private IState currentState;
    private FishingManager fishingManager;
    
    public void ChangeState(IState newState)
    {
        currentState?.OnExitState(fishingManager);
        currentState = newState;
        currentState.OnEnterState(fishingManager);
    }
    
    void Update()
    {
        currentState?.OnStayState(fishingManager);
    }
}
```

### ğŸŸ é­šé¡æ•¸æ“šç³»çµ±

```csharp
// é­šé¡æ•¸æ“šç®¡ç†å™¨
public class FishDataManager : MonoBehaviour
{
    [Header("é­šé¡æ•¸æ“š")]
    public FishObject fishDatabase;                // é­šé¡è³‡æ–™åº«
    public FishDifficultyCalculator calculator;   // é›£åº¦è¨ˆç®—å™¨
    
    [Header("æ°´å€é…ç½®")]
    public FishPoolConfig[] depthConfigs;         // å„æ°´æ·±çš„é­šæ± é…ç½®
    
    // æ ¹æ“šæ°´æ·±é¸æ“‡é­šé¡
    public FishSpecies SelectFishByDepth(int depthLevel)
    {
        FishPoolConfig config = depthConfigs[depthLevel - 1];
        List<FishSpecies> availableFish = GetAvailableFish(depthLevel);
        
        return SelectFishByWeight(availableFish, config.weightDistribution);
    }
    
    // è¨ˆç®—é­šé¡æ•¸å€¼
    public FishStats CalculateFishStats(FishSpecies fish)
    {
        return calculator.CalculateFishStats(fish);
    }
    
    // ç²å–é­šé¡å”®åƒ¹
    public int GetFishPrice(FishSpecies fish)
    {
        int baseMultiplier = fish.rarity == FishRarity.Rare ? 15 : 10;
        return fish.difficultyLevel * baseMultiplier;
    }
}

// é­šæ± é…ç½®
[System.Serializable]
public class FishPoolConfig
{
    public int depthLevel;                        // æ°´æ·±ç­‰ç´š
    public List<FishSpecies> fishPool;           // é­šæ± 
    public WeightDistribution weightDistribution; // æ¬Šé‡åˆ†å¸ƒ
}

// æ¬Šé‡åˆ†å¸ƒé…ç½®
[System.Serializable] 
public class WeightDistribution
{
    public float[] levelWeights;    // å„ç­‰ç´šæ¬Šé‡
    public float rareWeight;        // ç¨€æœ‰é­šæ¬Šé‡
}
```

---

## ğŸ® éŠæˆ²ç©æ³•ç³»çµ±

### ğŸ¯ QTEç³»çµ±æ¶æ§‹

```csharp
// QTEç®¡ç†å™¨
public class QTESliderManager : MonoBehaviour
{
    [Header("QTEçµ„ä»¶")]
    public SliderQTE_PlayerCtrl playerController;     // ç©å®¶æ§åˆ¶å™¨
    public SliderQTE_TargetArea targetArea;          // ç›®æ¨™å€åŸŸ
    
    [Header("QTEç‹€æ…‹")]
    public bool isQTEActive;                         // QTEæ˜¯å¦æ¿€æ´»
    public bool isPlayerInArea;                      // ç©å®¶æ˜¯å¦åœ¨ç›®æ¨™å€åŸŸ
    public bool isStop;                              // æ˜¯å¦æš«åœ (æ¸¬è©¦åŠŸèƒ½)
    
    // å•Ÿå‹•QTEç³»çµ±
    public void StartQTE(FishStats fishStats)
    {
        isQTEActive = true;
        
        // æ ¹æ“šé­šé¡æ•¸å€¼èª¿æ•´QTEåƒæ•¸
        targetArea.SetMovementSpeed(fishStats.qteSpeed);
        playerController.SetSensitivity(1.0f);
        
        // å•Ÿå‹•å‹•ç•«
        GetComponent<Animator>().SetTrigger("StartQTE");
    }
    
    // åœæ­¢QTEç³»çµ±
    public void StopQTE()
    {
        isQTEActive = false;
        GetComponent<Animator>().SetTrigger("StopQTE");
    }
    
    // æª¢æŸ¥ç©å®¶æ˜¯å¦åœ¨ç›®æ¨™å€åŸŸ
    public bool IsPlayerInTargetArea()
    {
        if (!isQTEActive || isStop) return false;
        
        float playerPos = playerController.transform.position.x;
        float targetPos = targetArea.transform.position.x;
        float targetWidth = targetArea.GetAreaWidth();
        
        return Mathf.Abs(playerPos - targetPos) <= targetWidth / 2;
    }
}

// ç©å®¶æ§åˆ¶å™¨
public class SliderQTE_PlayerCtrl : MonoBehaviour
{
    [Header("æ§åˆ¶åƒæ•¸")]
    public float moveSpeed = 3.0f;
    public float sensitivity = 1.0f;
    
    void Update()
    {
        if (Input.GetKey(KeyCode.LeftArrow) || Input.GetKey(KeyCode.A))
            MovePlayer(-1);
        else if (Input.GetKey(KeyCode.RightArrow) || Input.GetKey(KeyCode.D))
            MovePlayer(1);
    }
    
    private void MovePlayer(float direction)
    {
        float movement = direction * moveSpeed * sensitivity * Time.deltaTime;
        Vector3 newPos = transform.position + Vector3.right * movement;
        newPos.x = Mathf.Clamp(newPos.x, -3f, 3f);
        transform.position = newPos;
    }
}

// ç›®æ¨™å€åŸŸæ§åˆ¶å™¨
public class SliderQTE_TargetArea : MonoBehaviour
{
    [Header("ç§»å‹•åƒæ•¸")]
    public float moveSpeed = 2.0f;
    public float areaWidth = 1.0f;
    
    private float direction = 1f;
    private float changeDirectionTimer;
    
    void Update()
    {
        MoveTarget();
        UpdateDirectionChange();
    }
    
    private void MoveTarget()
    {
        transform.position += Vector3.right * direction * moveSpeed * Time.deltaTime;
        
        // é‚Šç•Œæª¢æŸ¥
        if (transform.position.x >= 2.5f) direction = -1f;
        else if (transform.position.x <= -2.5f) direction = 1f;
    }
    
    public void SetMovementSpeed(float speed)
    {
        moveSpeed = speed;
    }
    
    public float GetAreaWidth()
    {
        return areaWidth;
    }
}
```

### ğŸ’ª é›£åº¦ç³»çµ±æ¶æ§‹

```csharp
// é›£åº¦è¨ˆç®—å™¨
public class FishDifficultyCalculator : MonoBehaviour
{
    [Header("åŸºç¤æ•¸å€¼")]
    public float baseQTESpeed = 2.0f;
    public float baseStaminaDamage = 10.0f;
    public float baseMissedPenalty = 15.0f;
    public float baseStamina = 100.0f;
    
    [Header("é¡å‹ä¿®æ­£ä¿‚æ•¸")]
    public FishTypeModifier balancedModifier = new FishTypeModifier(1.0f, 1.0f, 1.0f);
    public FishTypeModifier speedModifier = new FishTypeModifier(1.5f, 0.7f, 1.0f);
    public FishTypeModifier powerModifier = new FishTypeModifier(0.7f, 1.0f, 1.5f);
    
    // è¨ˆç®—é­šé¡æ•¸å€¼
    public FishStats CalculateFishStats(FishSpecies fish)
    {
        float levelMultiplier = fish.difficultyLevel;
        FishTypeModifier modifier = GetTypeModifier(fish.fishType);
        
        return new FishStats
        {
            qteSpeed = baseQTESpeed * levelMultiplier * modifier.speedMultiplier,
            staminaDamage = baseStaminaDamage * levelMultiplier * modifier.damageMultiplier,
            missedPenalty = baseMissedPenalty * levelMultiplier * modifier.penaltyMultiplier,
            maxStamina = baseStamina * levelMultiplier,
            sellPrice = CalculateSellPrice(fish)
        };
    }
    
    private FishTypeModifier GetTypeModifier(FishType type)
    {
        switch(type)
        {
            case FishType.Balanced: return balancedModifier;
            case FishType.Speed: return speedModifier;
            case FishType.Power: return powerModifier;
            default: return balancedModifier;
        }
    }
    
    private int CalculateSellPrice(FishSpecies fish)
    {
        int baseMultiplier = fish.rarity == FishRarity.Rare ? 15 : 10;
        return fish.difficultyLevel * baseMultiplier;
    }
}

// é¡å‹ä¿®æ­£ä¿‚æ•¸
[System.Serializable]
public struct FishTypeModifier
{
    public float speedMultiplier;    // é€Ÿåº¦ä¿‚æ•¸
    public float damageMultiplier;   // å‚·å®³ä¿‚æ•¸
    public float penaltyMultiplier;  // æ‡²ç½°ä¿‚æ•¸
    
    public FishTypeModifier(float speed, float damage, float penalty)
    {
        speedMultiplier = speed;
        damageMultiplier = damage;
        penaltyMultiplier = penalty;
    }
}

// é­šé¡æ•¸å€¼çµæ§‹
[System.Serializable]
public struct FishStats
{
    public float qteSpeed;           // QTEç§»å‹•é€Ÿåº¦
    public float staminaDamage;      // é«”åŠ›å‚·å®³
    public float missedPenalty;      // å¤±èª¤æ‡²ç½°
    public float maxStamina;         // æœ€å¤§é«”åŠ›
    public int sellPrice;            // å”®åƒ¹
}
```

---

## ğŸ–¥ï¸ UIç³»çµ±æ¶æ§‹

### ğŸ“Š UIç®¡ç†å™¨

```csharp
// UIç®¡ç†å™¨
public class FishingUIManager : MonoBehaviour
{
    [Header("UIçµ„ä»¶")]
    public StaminaComponent staminaDisplay;          // é«”åŠ›é¡¯ç¤º
    public LevelSetingComponent depthSelector;       // æ·±åº¦é¸æ“‡å™¨
    public FishingSettlementUI settlementUI;         // çµç®—ç•Œé¢
    public GameObject qtePanel;                      // QTEé¢æ¿
    
    [Header("å‹•ç•«æ§åˆ¶")]
    public Animator uiAnimator;                      // UIå‹•ç•«å™¨
    
    // æ›´æ–°é«”åŠ›é¡¯ç¤º
    public void UpdateStaminaDisplay(float current, float max)
    {
        staminaDisplay.DisplayFishStaminaComponent(max, current);
    }
    
    // é¡¯ç¤ºçµç®—ç•Œé¢
    public void ShowSettlement(FishSpecies fish, int price)
    {
        settlementUI.ShowSettlement(fish, price);
        uiAnimator.SetTrigger("ShowSettlement");
    }
    
    // éš±è—çµç®—ç•Œé¢
    public void HideSettlement()
    {
        settlementUI.HideSettlement();
        uiAnimator.SetTrigger("HideSettlement");
    }
    
    // è¨­ç½®æ·±åº¦ç­‰ç´š
    public void SetDepthLevel(int level)
    {
        depthSelector.DepthLevelSet(level);
    }
}

// çµç®—UI
public class FishingSettlementUI : MonoBehaviour
{
    [Header("UIå…ƒç´ ")]
    public Image fishImage;              // é­šé¡åœ–ç‰‡
    public Text fishNameText;            // é­šé¡åç¨±
    public Text priceText;               // åƒ¹æ ¼æ–‡å­—
    public Button sellButton;            // å”®å‡ºæŒ‰éˆ•
    public Button keepButton;            // æ”¶è—æŒ‰éˆ•
    
    private FishSpecies currentFish;
    private int currentPrice;
    
    public void ShowSettlement(FishSpecies fish, int price)
    {
        currentFish = fish;
        currentPrice = price;
        
        fishImage.sprite = fish.fishImage;
        fishNameText.text = fish.fishName;
        priceText.text = price.ToString() + "å…ƒ";
        
        gameObject.SetActive(true);
        
        // è¨­ç½®æŒ‰éˆ•äº‹ä»¶
        sellButton.onClick.RemoveAllListeners();
        sellButton.onClick.AddListener(OnSellButtonClicked);
        
        keepButton.onClick.RemoveAllListeners();
        keepButton.onClick.AddListener(OnKeepButtonClicked);
    }
    
    private void OnSellButtonClicked()
    {
        // é€šçŸ¥ç¶“æ¿Ÿç³»çµ±å¢åŠ é‡‘éŒ¢
        GameManager.Instance.EconomySystem.AddMoney(currentPrice);
        
        // é—œé–‰çµç®—UI
        HideSettlement();
        
        // é€šçŸ¥é‡£é­šç®¡ç†å™¨ç¹¼çºŒ
        FindObjectOfType<FishingManager>().OnFishSettled(true);
    }
    
    private void OnKeepButtonClicked()
    {
        // é€šçŸ¥åº«å­˜ç³»çµ±æ·»åŠ é­šé¡
        GameManager.Instance.InventorySystem.AddFish(currentFish);
        
        // é—œé–‰çµç®—UI
        HideSettlement();
        
        // é€šçŸ¥é‡£é­šç®¡ç†å™¨ç¹¼çºŒ
        FindObjectOfType<FishingManager>().OnFishSettled(false);
    }
    
    public void HideSettlement()
    {
        gameObject.SetActive(false);
    }
}
```

---

## ğŸ”Œ ç³»çµ±æ•´åˆæ¶æ§‹

### â° æ™‚é–“ç³»çµ±æ•´åˆ

```csharp
// æ™‚é–“ç®¡ç†æ•´åˆ
public class FishingTimeManager : MonoBehaviour
{
    [Header("æ™‚é–“é…ç½®")]
    public int maxFishPerAction = 2;             // æ¯å€‹è¡Œå‹•é»æœ€å¤šé‡£é­šæ•¸
    public int totalActionPoints;                // ç¸½è¡Œå‹•é»æ•¸
    public int usedActionPoints;                 // å·²ä½¿ç”¨è¡Œå‹•é»
    
    // æª¢æŸ¥æ˜¯å¦å¯ä»¥ç¹¼çºŒé‡£é­š
    public bool CanContinueFishing(int currentFishCount)
    {
        // æª¢æŸ¥è¡Œå‹•é»æ˜¯å¦è¶³å¤ 
        int requiredActionPoints = Mathf.CeilToInt((float)currentFishCount / maxFishPerAction);
        return requiredActionPoints < totalActionPoints;
    }
    
    // æ¶ˆè€—è¡Œå‹•é»
    public void ConsumeActionPoint()
    {
        usedActionPoints++;
        
        // é€šçŸ¥é¤Šæˆç³»çµ±æ›´æ–°æ™‚é–“
        GameManager.Instance.NurturingSystem.ConsumeActionPoint();
        
        // æª¢æŸ¥æ˜¯å¦éœ€è¦å¼·åˆ¶çµæŸ
        if (usedActionPoints >= totalActionPoints)
        {
            FindObjectOfType<FishingManager>().ForceEndFishing();
        }
    }
}

// ç¶“æ¿Ÿç³»çµ±æ•´åˆ
public class FishingEconomyManager : MonoBehaviour
{
    // è™•ç†é­šé¡å”®å‡º
    public void SellFish(FishSpecies fish, int price)
    {
        GameManager.Instance.EconomySystem.AddMoney(price);
        
        // è¨˜éŒ„å”®å‡ºçµ±è¨ˆ
        GameManager.Instance.StatisticsSystem.RecordFishSold(fish, price);
    }
    
    // è™•ç†é­šé¡æ”¶è—
    public void KeepFish(FishSpecies fish)
    {
        // ä¸€èˆ¬é­šå’Œç¨€æœ‰é­šåˆ†åˆ¥è™•ç†
        if (fish.rarity == FishRarity.Rare)
        {
            GameManager.Instance.InventorySystem.AddRareFish(fish);
        }
        else
        {
            GameManager.Instance.InventorySystem.AddCommonFish(fish);
        }
    }
}
```

### ğŸ’¾ å­˜æª”ç³»çµ±æ•´åˆ

```csharp
// é‡£é­šæ•¸æ“šå­˜æª”
[System.Serializable]
public class FishingData
{
    public int fishingLevel;                     // é‡£é­šç­‰ç´š
    public int totalFishCaught;                  // ç¸½é‡£é­šæ•¸é‡
    public int totalMoneyEarned;                 // ç¸½è³ºå–é‡‘éŒ¢
    public List<string> caughtFishIds;          // å·²é‡£ç²é­šé¡IDåˆ—è¡¨
    public Dictionary<string, int> fishCounts;   // å„ç¨®é­šé¡æ•¸é‡çµ±è¨ˆ
    public int rareFishCount;                    // ç¨€æœ‰é­šç¸½æ•¸
    public int commonFishCount;                  // ä¸€èˆ¬é­šç¸½æ•¸
}

// å­˜æª”ç®¡ç†å™¨
public class FishingSaveManager : MonoBehaviour
{
    private const string SAVE_KEY = "FishingData";
    
    // ä¿å­˜é‡£é­šæ•¸æ“š
    public void SaveFishingData(FishingData data)
    {
        string jsonData = JsonUtility.ToJson(data);
        PlayerPrefs.SetString(SAVE_KEY, jsonData);
        PlayerPrefs.Save();
    }
    
    // è¼‰å…¥é‡£é­šæ•¸æ“š
    public FishingData LoadFishingData()
    {
        if (PlayerPrefs.HasKey(SAVE_KEY))
        {
            string jsonData = PlayerPrefs.GetString(SAVE_KEY);
            return JsonUtility.FromJson<FishingData>(jsonData);
        }
        
        return new FishingData(); // è¿”å›é»˜èªæ•¸æ“š
    }
}
```

---

## ğŸš€ åˆå§‹åŒ–æµç¨‹

### ğŸ“‹ ç³»çµ±å•Ÿå‹•é †åº

```csharp
// é‡£é­šç³»çµ±åˆå§‹åŒ–ç®¡ç†å™¨
public class FishingSystemInitializer : MonoBehaviour
{
    [Header("ç³»çµ±çµ„ä»¶")]
    public FishingManager fishingManager;
    public FishDataManager fishDataManager;
    public QTESliderManager qteManager;
    public FishingUIManager uiManager;
    public FishingTimeManager timeManager;
    
    // ç³»çµ±åˆå§‹åŒ–
    public void InitializeSystem(int actionPoints)
    {
        // 1. è¼‰å…¥é­šé¡è³‡æ–™åº«
        fishDataManager.LoadFishDatabase();
        
        // 2. åˆå§‹åŒ–æ™‚é–“ç®¡ç†
        timeManager.Initialize(actionPoints);
        
        // 3. åˆå§‹åŒ–UIç³»çµ±
        uiManager.InitializeUI();
        
        // 4. åˆå§‹åŒ–QTEç³»çµ±
        qteManager.InitializeQTE();
        
        // 5. å•Ÿå‹•ä¸»æ§åˆ¶å™¨
        fishingManager.InitializeFishingSystem(actionPoints);
        
        Debug.Log("é‡£é­šç³»çµ±åˆå§‹åŒ–å®Œæˆ");
    }
    
    // ç³»çµ±æ¸…ç†
    public void CleanupSystem()
    {
        // ä¿å­˜æ•¸æ“š
        SaveCurrentProgress();
        
        // æ¸…ç†çµ„ä»¶
        fishingManager.Cleanup();
        qteManager.Cleanup();
        uiManager.Cleanup();
        
        Debug.Log("é‡£é­šç³»çµ±æ¸…ç†å®Œæˆ");
    }
    
    private void SaveCurrentProgress()
    {
        FishingData data = CollectCurrentData();
        FindObjectOfType<FishingSaveManager>().SaveFishingData(data);
    }
}
```

---

## ğŸ’¬ Claude ä½¿ç”¨æç¤º

é–‹ç™¼é‡£é­šç³»çµ±ç¨‹å¼æ¶æ§‹æ™‚è«‹æ³¨æ„ï¼š

1. **ç‹€æ…‹æ©Ÿæ¨¡å¼**: åš´æ ¼éµå¾ª `IState` æ¥å£ï¼Œç¢ºä¿ç‹€æ…‹è½‰æ›çš„æ¸…æ™°æ€§
2. **æ¨¡çµ„åŒ–è¨­è¨ˆ**: å„å€‹ç®¡ç†å™¨è·è²¬å–®ä¸€ï¼Œé€šéäº‹ä»¶æˆ–ç›´æ¥å¼•ç”¨é€šä¿¡
3. **æ•¸æ“šé©…å‹•**: é­šé¡é…ç½®ã€é›£åº¦åƒæ•¸å®Œå…¨ç”±ScriptableObjectç®¡ç†
4. **æ€§èƒ½è€ƒæ…®**: QTEç³»çµ±çš„Updateé‚è¼¯éœ€è¦å„ªåŒ–ï¼Œé¿å…æ¯å¹€å¤§é‡è¨ˆç®—
5. **éŒ¯èª¤è™•ç†**: æ·»åŠ å®Œå–„çš„ç•°å¸¸è™•ç†ï¼Œç‰¹åˆ¥æ˜¯ç‹€æ…‹è½‰æ›å’Œæ•¸æ“šè¼‰å…¥
6. **æ¸¬è©¦å‹å¥½**: ä¿ç•™QTEæš«åœåŠŸèƒ½ä¾¿æ–¼æ¸¬è©¦ï¼Œä½†è¦æ¨™è¨˜ç‚ºæ¸¬è©¦åŠŸèƒ½
7. **æ“´å±•æ€§**: é ç•™æ¥å£ä¾¿æ–¼å¾ŒçºŒæ·»åŠ æ–°çš„é­šé¡é¡å‹å’Œæ©Ÿåˆ¶
8. **æ•´åˆè€ƒæ…®**: èˆ‡ä¸»éŠæˆ²ç³»çµ±çš„æ•¸æ“šåŒæ­¥å’Œç‹€æ…‹ç®¡ç†è¦è¬¹æ…è¨­è¨ˆ