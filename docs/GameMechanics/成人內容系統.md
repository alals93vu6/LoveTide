# ğŸ” æˆäººå…§å®¹ç³»çµ±æ¶æ§‹

> LoveTide æˆäººå…§å®¹ç³»çµ±çš„å®Œæ•´æŠ€è¡“æ¶æ§‹è¨­è¨ˆï¼ŒåŸºæ–¼å¯¦éš›ç¨‹å¼ç¢¼åˆ†æçš„å°ˆæ¥­æ–‡æª”

---

## ğŸ¯ æ¦‚è¿°

æˆäººå…§å®¹ç³»çµ±æ˜¯ LoveTide éŠæˆ²çš„æ ¸å¿ƒé«”é©—ç³»çµ±ï¼Œæ¡ç”¨**åˆ†å±¤ç‹€æ…‹æ©Ÿ**å’Œ**çµ„ä»¶åŒ–è¨­è¨ˆ**ï¼Œå¯¦ç¾äº†è¤‡é›œè€Œæµæš¢çš„äº’å‹•é«”é©—ã€‚ç³»çµ±é€šéç²¾å¯†çš„æ•¸å€¼è¨ˆç®—ã€å¤šéƒ¨ä½å”èª¿æ©Ÿåˆ¶å’Œå‹•æ…‹UIåé¥‹ï¼Œç‚ºç©å®¶æä¾›æ²‰æµ¸å¼çš„è¦ªå¯†äº’å‹•é«”é©—ã€‚

## ğŸ­ ç³»çµ±ç‰¹è‰²

### ğŸŒŸ æ ¸å¿ƒäº®é»
- **åˆ†å±¤ç‹€æ…‹æ©Ÿ**: ä¸»ç‹€æ…‹æ§åˆ¶è¡Œç‚ºæ¨¡å¼ï¼Œå­ç‹€æ…‹æ§åˆ¶èº«é«”éƒ¨ä½
- **å¤šéƒ¨ä½å”èª¿**: æ”¯æ´é ­éƒ¨ã€èƒ¸éƒ¨ã€æ‰‹éƒ¨ã€èº«é«”çš„åŒæ™‚äº’å‹•
- **å‹•æ…‹æ•¸å€¼ç³»çµ±**: åŸºæ–¼æ•æ„Ÿåº¦ã€é«”åŠ›ã€å¿«æ„Ÿçš„å¯¦æ™‚è¨ˆç®—
- **æ™ºèƒ½è¡çªè™•ç†**: è‡ªå‹•è§£æ±ºä¸åˆç†çš„å‹•ä½œçµ„åˆ
- **æ·±åº¦æ•´åˆ**: èˆ‡è§’è‰²é¤Šæˆç³»çµ±ç„¡ç¸«çµåˆ

### ğŸ® ç©æ³•ç‰¹é»
- **è‡ªç”±æ“ä½œ**: ç©å®¶å¯è‡ªç”±é¸æ“‡äº’å‹•æ–¹å¼å’Œç¯€å¥
- **å¯¦æ™‚åé¥‹**: å³æ™‚çš„æ•¸å€¼è®ŠåŒ–å’Œè¦–è¦ºåé¥‹
- **å€‹æ€§åŒ–é«”é©—**: åŸºæ–¼è§’è‰²æ•¸å€¼çš„å·®ç•°åŒ–åæ‡‰
- **è±å¯Œè®ŠåŒ–**: å¤šç¨®ç‹€æ…‹çµ„åˆå‰µé€ è±å¯Œé«”é©—

---

## ğŸ—ï¸ ç³»çµ±æ¶æ§‹åœ–

```
ğŸ” æˆäººå…§å®¹ç³»çµ±æ¶æ§‹ (æ¨¡çµ„åŒ–è¨­è¨ˆ)
â”‚
â”œâ”€â”€ ğŸ® æ ¸å¿ƒç®¡ç†å±¤ (Core Management Layer)
â”‚   â””â”€â”€ SexyGameManager - æˆäººå…§å®¹ä¸»ç®¡ç†å™¨
â”‚       â”œâ”€â”€ å§¿å‹¢åˆ‡æ›ç®¡ç†
â”‚       â”œâ”€â”€ æ•¸å€¼ç³»çµ±å”èª¿  
â”‚       â””â”€â”€ å…¨å±€ç‹€æ…‹æ§åˆ¶
â”‚
â”œâ”€â”€ ğŸ­ å§¿å‹¢ç®¡ç†å±¤ (Position Management Layer)
â”‚   â”œâ”€â”€ NormalPositionManager - æ­£å¸¸ä½ç®¡ç†å™¨
â”‚   â”‚   â”œâ”€â”€ NormalPlayerController - æ­£å¸¸ä½æŒ‰éˆ•æ§åˆ¶å™¨
â”‚   â”‚   â””â”€â”€ NormalSpineManager - æ­£å¸¸ä½å‹•ç•«ç®¡ç†å™¨
â”‚   â”‚
â”‚   â”œâ”€â”€ CowgirlPositionManager - å¥³ä¸Šä½ç®¡ç†å™¨  
â”‚   â”‚   â”œâ”€â”€ CowgirlPlayerController - å¥³ä¸Šä½æŒ‰éˆ•æ§åˆ¶å™¨
â”‚   â”‚   â””â”€â”€ CowgirlSpineManager - å¥³ä¸Šä½å‹•ç•«ç®¡ç†å™¨
â”‚   â”‚
â”‚   â””â”€â”€ DoggystylePositionManager - èƒŒå¾Œä½ç®¡ç†å™¨
â”‚       â”œâ”€â”€ DoggystylePlayerController - èƒŒå¾Œä½æŒ‰éˆ•æ§åˆ¶å™¨
â”‚       â””â”€â”€ DoggystyleSpineManager - èƒŒå¾Œä½å‹•ç•«ç®¡ç†å™¨
â”‚
â”œâ”€â”€ ğŸ—‚ï¸ å…±äº«ç³»çµ±å±¤ (Shared Systems Layer)  
â”‚   â”œâ”€â”€ NumericalRecords_Sexy - é€šç”¨æ•¸å€¼ç®¡ç†ç³»çµ±
â”‚   â”‚   â”œâ”€â”€ å¿«æ„Ÿå€¼è¨ˆç®— (playerDelight, girlDelight)
â”‚   â”‚   â”œâ”€â”€ é«”åŠ›ç³»çµ± (playerStamina, girlStamina)
â”‚   â”‚   â”œâ”€â”€ æ•æ„Ÿåº¦è¨ˆç®— (åŸºæ–¼slutty, lust, orgasmNumber)
â”‚   â”‚   â””â”€â”€ é«˜æ½®æª¢æ¸¬ç³»çµ± (OrgasmDetected, StimulationDetected)
â”‚   â”‚
â”‚   â”œâ”€â”€ SexyUIManager - é€šç”¨UIç®¡ç†ç³»çµ±
â”‚   â”‚   â”œâ”€â”€ æ•¸å€¼é¡¯ç¤ºæ›´æ–° (è¡€æ¢ã€å¿«æ„Ÿæ¢)  
â”‚   â”‚   â”œâ”€â”€ æŒ‰éˆ•ç‹€æ…‹ç®¡ç† (å¯ç”¨æ€§æ§åˆ¶)
â”‚   â”‚   â””â”€â”€ æ»‘æ¡¿æ§åˆ¶ç³»çµ± (é€Ÿåº¦èª¿ç¯€)
â”‚   â”‚
â”‚   â””â”€â”€ AudioManager_Sexy - éŸ³æ•ˆç®¡ç†ç³»çµ±
â”‚       â”œâ”€â”€ éŸ³æ•ˆæ’­æ”¾æ§åˆ¶
â”‚       â”œâ”€â”€ éŸ³é‡å‹•æ…‹èª¿æ•´
â”‚       â””â”€â”€ æƒ…å¢ƒéŸ³æ•ˆåˆ‡æ›
â”‚
â””â”€â”€ ğŸ”„ ç‹€æ…‹åŒæ­¥ç³»çµ± (State Synchronization System)
    â”œâ”€â”€ å§¿å‹¢é–“æ•¸å€¼å‚³é
    â”œâ”€â”€ å‹•ç•«ç‹€æ…‹åŒæ­¥  
    â””â”€â”€ UIç‹€æ…‹æ›´æ–°å»£æ’­
```

---

## ğŸ›ï¸ ç‹€æ…‹æ©Ÿç³»çµ±æ¶æ§‹

### ğŸ”„ ç‹€æ…‹æ¥å£è¨­è¨ˆ

```csharp
public interface IState
{ 
    void OnEnterState(object action);   // é€²å…¥ç‹€æ…‹æ™‚çš„è™•ç†
    void OnStayState(object action);    // åœç•™åœ¨ç‹€æ…‹æ™‚çš„è™•ç†
    void OnExitState(object action);    // é›¢é–‹ç‹€æ…‹æ™‚çš„è™•ç†
}
```

### ğŸ¯ ä¸»ç‹€æ…‹æµç¨‹

```csharp
public class PlayerActor_Sexy : MonoBehaviour
{
    [Header("ç‹€æ…‹æ©Ÿ")]
    public IState currentState;
    public StateEnum currentStateEnum;
    
    // ğŸ® ä¸»ç‹€æ…‹é¡å‹
    public enum StateEnum
    {
        IdleState,          // å¾…æ©Ÿç‹€æ…‹
        HandJobState,       // æ‰‹éƒ¨äº’å‹•ç‹€æ…‹
        ThrustingState,     // æ¨é€²ç‹€æ…‹
        ReadyCumState,      // æº–å‚™é«˜æ½®ç‹€æ…‹
        CumState_Player,    // ç©å®¶é«˜æ½®ç‹€æ…‹
        CumState_Girl,      // å¥³æ€§è§’è‰²é«˜æ½®ç‹€æ…‹
        CumState_Pair       // é›™æ–¹é«˜æ½®ç‹€æ…‹
    }
    
    // ğŸ”„ ç‹€æ…‹åˆ‡æ›æ ¸å¿ƒæ–¹æ³•
    public void ChangeState(IState newState)
    {
        currentState?.OnExitState(this);
        currentState = newState;
        currentState?.OnEnterState(this);
    }
    
    void Update()
    {
        currentState?.OnStayState(this);
        
        // ğŸ¯ è‡ªå‹•ç‹€æ…‹æª¢æ¸¬
        OrgasmDetected();        // é«˜æ½®æª¢æ¸¬
        StimulationDetected();   // åˆºæ¿€æª¢æ¸¬
    }
}
```

### ğŸ­ èº«é«”éƒ¨ä½å­ç‹€æ…‹

```csharp
// èƒ¸éƒ¨æ§åˆ¶ç‹€æ…‹ç¯„ä¾‹
public class OnGraspState_Chests : IState
{
    public void OnEnterState(object action)
    {
        var chestsCtrl = (SexyCtrl_Chests)action;
        chestsCtrl.OnGrasp();           // é–‹å§‹æŠ“æ¡å‹•ä½œ
        chestsCtrl.stimulation = true;   // è¨­å®šåˆºæ¿€ç‹€æ…‹
    }
    
    public void OnStayState(object action)
    {
        var chestsCtrl = (SexyCtrl_Chests)action;
        
        // æŒçºŒåˆºæ¿€æ•ˆæœ
        chestsCtrl.ApplyStimulation();
        
        // æª¢æŸ¥ç‹€æ…‹è®Šæ›´æ¢ä»¶
        if (chestsCtrl.shouldExitGrasp)
        {
            chestsCtrl.ChangeState(new IdleState_Chests());
        }
    }
    
    public void OnExitState(object action)
    {
        var chestsCtrl = (SexyCtrl_Chests)action;
        chestsCtrl.StopGrasp();         // åœæ­¢æŠ“æ¡å‹•ä½œ
        chestsCtrl.stimulation = false;  // æ¸…é™¤åˆºæ¿€ç‹€æ…‹
    }
}
```

---

## ğŸ® äº’å‹•æ§åˆ¶

### ğŸ‘† è§¸æ§ç³»çµ±
```csharp
public class TouchController : MonoBehaviour
{
    public TouchZone[] touchZones;     // å¯è§¸æ‘¸å€åŸŸ
    public float sensitivity;          // è§¸æ‘¸éˆæ•åº¦
    public AnimationCurve responseCurve; // åæ‡‰æ›²ç·š
}
```

### ğŸ¯ è§¸æ‘¸å€åŸŸ
- **é ­éƒ¨å€åŸŸ**: è‡‰é °ã€é¡é ­ã€é ­é«®ç­‰éƒ¨ä½
- **èº«é«”å€åŸŸ**: è‚©è†€ã€æ‰‹è‡‚ã€è…°éƒ¨ç­‰éƒ¨ä½
- **æ•æ„Ÿå€åŸŸ**: éœ€è¦æ›´é«˜è¦ªå¯†åº¦æ‰èƒ½è§¸æ‘¸çš„éƒ¨ä½
- **ç¦å¿Œå€åŸŸ**: ç‰¹å®šæ¢ä»¶ä¸‹æ‰èƒ½äº’å‹•çš„å€åŸŸ

---

## ğŸ­ å‹•ç•«ç³»çµ±

### ğŸ¨ Spine å‹•ç•«æ•´åˆ
```csharp
public class SexyAnimationController : MonoBehaviour
{
    public SkeletonAnimation characterSpine;
    public AnimationStateData stateData;
    
    public void PlayTouchAnimation(string bodyPart, float intensity)
    {
        // æ’­æ”¾å°æ‡‰éƒ¨ä½çš„è§¸æ‘¸å‹•ç•«
    }
}
```

---

## ğŸ˜Š æƒ…ç·’åæ‡‰ç³»çµ±

### ğŸ­ æƒ…ç·’ç‹€æ…‹
```csharp
public enum EmotionState
{
    Neutral,     // ä¸­æ€§
    Shy,         // å®³ç¾
    Happy,       // é–‹å¿ƒ
    Excited,     // èˆˆå¥®
    Embarrassed, // å°·å°¬
    Satisfied    // æ»¿è¶³
}
```

### ğŸ“ˆ æƒ…ç·’è®ŠåŒ–å› ç´ 
- **è¦ªå¯†åº¦å½±éŸ¿**: è¦ªå¯†åº¦è¶Šé«˜ï¼Œæ­£é¢æƒ…ç·’è¶Šå®¹æ˜“è§¸ç™¼
- **æ™‚æ©ŸæŒæ¡**: åœ¨é©ç•¶æ™‚æ©Ÿé€²è¡Œäº’å‹•ç²å¾—æ›´å¥½åæ‡‰

---

## ğŸ” è§£é–æ©Ÿåˆ¶

### ğŸ“‹ è§£é–æ¢ä»¶
```json
{
    "unlockConditions": {
        "minAffection": 80,
        "requiredEvents": ["date_night", "confession_accepted"],
        "timeOfDay": "night",
        "locationRequired": "private_room"
    }
}
```


---

## ğŸµ éŸ³æ•ˆç³»çµ±

### ğŸ”Š éŸ³æ•ˆé¡å‹
```csharp
public enum SexyAudioType
{
    Breathing,      // å‘¼å¸è²
    Heartbeat,      // å¿ƒè·³è²
    VoiceReaction,  // è²éŸ³åæ‡‰
    Ambient,        // ç’°å¢ƒéŸ³æ•ˆ
    Climax          // é«˜æ½®éŸ³æ•ˆ
}
```

### ğŸ¶ éŸ³æ•ˆæ§åˆ¶
- **éŸ³é‡æ§åˆ¶**: æ ¹æ“šç©å®¶è¨­å®šèª¿æ•´éŸ³é‡
- **æƒ…å¢ƒé©æ‡‰**: æ ¹æ“šç•¶å‰ç‹€æ…‹æ’­æ”¾é©åˆçš„éŸ³æ•ˆ
- **éš¨æ©Ÿè®ŠåŒ–**: é¿å…éŸ³æ•ˆé‡è¤‡é€ æˆçš„å–®èª¿æ„Ÿ
- **æ·¡å…¥æ·¡å‡º**: å¹³æ»‘çš„éŸ³æ•ˆéæ¸¡

---

## ğŸ“Š æ•¸æ“šè¿½è¹¤

### ğŸ“ˆ äº’å‹•è¨˜éŒ„
```csharp
public class IntimacyData
{
    public int totalInteractions;      // ç¸½äº’å‹•æ¬¡æ•¸
    public Dictionary<string, int> bodyPartTouches; // å„éƒ¨ä½è§¸æ‘¸æ¬¡æ•¸
    public float averageSessionTime;   // å¹³å‡äº’å‹•æ™‚é–“
    public EmotionState preferredEmotion; // åå¥½æƒ…ç·’
}
```

---

## ğŸ”Œ ç³»çµ±æ•´åˆ

### ğŸ“¡ èˆ‡ä¸»éŠæˆ²çš„è¯ç¹«
- **å¥½æ„Ÿåº¦å½±éŸ¿**: æˆåŠŸçš„è¦ªå¯†äº’å‹•å¢åŠ å¥½æ„Ÿåº¦
- **åŠ‡æƒ…è§¸ç™¼**: æŸäº›åŠ‡æƒ…éœ€è¦é”åˆ°ç‰¹å®šè¦ªå¯†åº¦
- **æ™‚é–“æ¶ˆè€—**: è¦ªå¯†äº’å‹•æ¶ˆè€—éŠæˆ²æ™‚é–“
- **å¿ƒæƒ…å½±éŸ¿**: äº’å‹•çµæœå½±éŸ¿è§’è‰²å¿ƒæƒ…ç‹€æ…‹

### ğŸ”„ å­˜æª”ç³»çµ±
```csharp
public class IntimacySaveData
{
    public bool isUnlocked;            // æ˜¯å¦å·²è§£é–
    public int intimacyLevel;          // è¦ªå¯†åº¦ç­‰ç´š
    public List<string> unlockedActions; // å·²è§£é–å‹•ä½œ
    public IntimacyData playerData;    // ç©å®¶äº’å‹•æ•¸æ“š
}
```

---

## âš™ï¸ é…ç½®åƒæ•¸

### ğŸ¯ ç³»çµ±è¨­å®š
```json
{
    "intimacySettings": {
        "unlockAffectionThreshold": 80,
        "touchSensitivity": 0.8,
        "animationSpeed": 1.0,
        "emotionChangeSpeed": 0.5,
        "maxSessionTime": 1800
    }
}
```

---

## ğŸ—ï¸ æ¨¡çµ„åŒ–æ¶æ§‹å¯¦ç¾

### ğŸ® æ ¸å¿ƒç®¡ç†å™¨è¨­è¨ˆ

```csharp
public class SexyGameManager : MonoBehaviour
{
    [Header("å§¿å‹¢ç®¡ç†å™¨")]
    public NormalPositionManager normalPositionManager;
    public CowgirlPositionManager cowgirlPositionManager;
    public DoggystylePositionManager doggystylePositionManager;
    
    [Header("å…±äº«ç³»çµ±")]
    public NumericalRecords_Sexy sharedNumericalRecords;
    public SexyUIManager sharedUIManager;
    public AudioManager_Sexy audioManager;
    
    [Header("ç•¶å‰ç‹€æ…‹")]
    public PositionType currentPosition = PositionType.Normal;
    public bool isGameActive = true;
    
    private BasePositionManager currentPositionManager;
    
    void Start()
    {
        InitializeSystem();
        SwitchToPosition(PositionType.Normal);
    }
    
    // ğŸ¯ ç³»çµ±åˆå§‹åŒ–
    void InitializeSystem()
    {
        // åˆå§‹åŒ–å…±äº«æ•¸å€¼ç³»çµ±
        sharedNumericalRecords.Initialize();
        
        // è¨­å®šå„å§¿å‹¢ç®¡ç†å™¨çš„å…±äº«ç³»çµ±å¼•ç”¨
        normalPositionManager.SetSharedSystems(sharedNumericalRecords, sharedUIManager, audioManager);
        cowgirlPositionManager.SetSharedSystems(sharedNumericalRecords, sharedUIManager, audioManager);
        doggystylePositionManager.SetSharedSystems(sharedNumericalRecords, sharedUIManager, audioManager);
        
        // åˆå§‹ç‹€æ…‹ï¼šåœç”¨æ‰€æœ‰å§¿å‹¢ç®¡ç†å™¨
        normalPositionManager.gameObject.SetActive(false);
        cowgirlPositionManager.gameObject.SetActive(false);
        doggystylePositionManager.gameObject.SetActive(false);
    }
    
    // ğŸ”„ å§¿å‹¢åˆ‡æ›ä¸»æ–¹æ³•
    public void SwitchToPosition(PositionType newPosition)
    {
        // åœç”¨ç•¶å‰å§¿å‹¢ç®¡ç†å™¨
        if (currentPositionManager != null)
        {
            currentPositionManager.OnPositionExit();
            currentPositionManager.gameObject.SetActive(false);
        }
        
        // å•Ÿç”¨æ–°å§¿å‹¢ç®¡ç†å™¨
        currentPosition = newPosition;
        currentPositionManager = GetPositionManager(newPosition);
        currentPositionManager.gameObject.SetActive(true);
        currentPositionManager.OnPositionEnter();
        
        // æ›´æ–°UIé¡¯ç¤ºç•¶å‰å§¿å‹¢
        sharedUIManager.UpdatePositionDisplay(newPosition);
    }
    
    BasePositionManager GetPositionManager(PositionType position)
    {
        return position switch
        {
            PositionType.Normal => normalPositionManager,
            PositionType.Cowgirl => cowgirlPositionManager,
            PositionType.Doggystyle => doggystylePositionManager,
            _ => normalPositionManager
        };
    }
}
```

### ğŸ­ åŸºç¤å§¿å‹¢ç®¡ç†å™¨

```csharp
public abstract class BasePositionManager : MonoBehaviour
{
    [Header("æ§åˆ¶çµ„ä»¶")]
    protected BasePlayerController playerController;
    protected BaseSpineManager spineManager;
    
    [Header("å…±äº«ç³»çµ±å¼•ç”¨")]
    protected NumericalRecords_Sexy numericalRecords;
    protected SexyUIManager uiManager;
    protected AudioManager_Sexy audioManager;
    
    // ğŸ”— è¨­å®šå…±äº«ç³»çµ±å¼•ç”¨
    public virtual void SetSharedSystems(NumericalRecords_Sexy numerical, SexyUIManager ui, AudioManager_Sexy audio)
    {
        numericalRecords = numerical;
        uiManager = ui;
        audioManager = audio;
        
        // å‚³éçµ¦å­çµ„ä»¶
        playerController.SetSharedSystems(numerical, ui, audio);
        spineManager.SetSharedSystems(numerical, ui, audio);
    }
    
    // ğŸ¯ å§¿å‹¢é€²å…¥æ™‚çš„è™•ç†
    public virtual void OnPositionEnter()
    {
        // å•Ÿç”¨UIæ§åˆ¶é …ç›®
        uiManager.SetupPositionUI(GetPositionType());
        
        // åˆå§‹åŒ–å‹•ç•«ç‹€æ…‹
        spineManager.InitializeAnimations();
        
        // è¨­å®šæŒ‰éˆ•å›èª¿
        playerController.RegisterButtonCallbacks();
    }
    
    // ğŸšª å§¿å‹¢é€€å‡ºæ™‚çš„è™•ç†
    public virtual void OnPositionExit()
    {
        // æ¸…ç†UIç‹€æ…‹
        uiManager.CleanupPositionUI();
        
        // åœæ­¢ç•¶å‰å‹•ç•«
        spineManager.StopAllAnimations();
        
        // å–æ¶ˆæŒ‰éˆ•å›èª¿
        playerController.UnregisterButtonCallbacks();
    }
    
    protected abstract PositionType GetPositionType();
}
```

### ğŸ® å§¿å‹¢å°ˆå±¬ç®¡ç†å™¨ç¯„ä¾‹

```csharp
public class NormalPositionManager : BasePositionManager
{
    [Header("æ­£å¸¸ä½å°ˆç”¨çµ„ä»¶")]
    public NormalPlayerController normalPlayerController;
    public NormalSpineManager normalSpineManager;
    
    void Awake()
    {
        playerController = normalPlayerController;
        spineManager = normalSpineManager;
    }
    
    protected override PositionType GetPositionType() => PositionType.Normal;
    
    public override void OnPositionEnter()
    {
        base.OnPositionEnter();
        
        // æ­£å¸¸ä½ç‰¹æœ‰çš„åˆå§‹åŒ–
        normalPlayerController.SetupNormalControls();
        normalSpineManager.LoadNormalAnimations();
        
        // è¨­å®šæ­£å¸¸ä½çš„UIé…ç½®
        uiManager.ShowNormalPositionControls();
    }
}

public class CowgirlPositionManager : BasePositionManager
{
    [Header("å¥³ä¸Šä½å°ˆç”¨çµ„ä»¶")]
    public CowgirlPlayerController cowgirlPlayerController;
    public CowgirlSpineManager cowgirlSpineManager;
    
    void Awake()
    {
        playerController = cowgirlPlayerController;
        spineManager = cowgirlSpineManager;
    }
    
    protected override PositionType GetPositionType() => PositionType.Cowgirl;
    
    public override void OnPositionEnter()
    {
        base.OnPositionEnter();
        
        // å¥³ä¸Šä½ç‰¹æœ‰çš„åˆå§‹åŒ–
        cowgirlPlayerController.SetupCowgirlControls();
        cowgirlSpineManager.LoadCowgirlAnimations();
        
        // è¨­å®šå¥³ä¸Šä½çš„é›™å‘æ»‘æ¡¿UI
        uiManager.ShowCowgirlPositionControls();
    }
}
```

### ğŸ® åŸºç¤æŒ‰éˆ•æ§åˆ¶å™¨

```csharp
public abstract class BasePlayerController : MonoBehaviour
{
    [Header("å…±äº«ç³»çµ±å¼•ç”¨")]
    protected NumericalRecords_Sexy numericalRecords;
    protected SexyUIManager uiManager;
    protected AudioManager_Sexy audioManager;
    
    [Header("UIæ§åˆ¶çµ„ä»¶")]
    public Button[] actionButtons;
    public Slider[] controlSliders;
    
    public virtual void SetSharedSystems(NumericalRecords_Sexy numerical, SexyUIManager ui, AudioManager_Sexy audio)
    {
        numericalRecords = numerical;
        uiManager = ui;
        audioManager = audio;
    }
    
    // ğŸ”— è¨»å†ŠæŒ‰éˆ•å›èª¿
    public virtual void RegisterButtonCallbacks()
    {
        for (int i = 0; i < actionButtons.Length; i++)
        {
            int buttonIndex = i; // é–‰åŒ…æ•ç²
            actionButtons[i].onClick.AddListener(() => OnActionButtonClick(buttonIndex));
        }
        
        for (int i = 0; i < controlSliders.Length; i++)
        {
            int sliderIndex = i;
            controlSliders[i].onValueChanged.AddListener((value) => OnSliderValueChanged(sliderIndex, value));
        }
    }
    
    // ğŸš« å–æ¶ˆæŒ‰éˆ•å›èª¿
    public virtual void UnregisterButtonCallbacks()
    {
        foreach (var button in actionButtons)
        {
            button.onClick.RemoveAllListeners();
        }
        
        foreach (var slider in controlSliders)
        {
            slider.onValueChanged.RemoveAllListeners();
        }
    }
    
    protected abstract void OnActionButtonClick(int buttonIndex);
    protected abstract void OnSliderValueChanged(int sliderIndex, float value);
}
```

### ğŸ¨ åŸºç¤å‹•ç•«ç®¡ç†å™¨ (æ•´åˆç¯€æ‹æ§åˆ¶)

```csharp
public abstract class BaseSpineManager : MonoBehaviour
{
    [Header("Spineå‹•ç•«çµ„ä»¶")]
    public SkeletonAnimation playerSkeleton;
    public SkeletonAnimation girlSkeleton;
    
    [Header("å…±äº«ç³»çµ±å¼•ç”¨")]
    protected NumericalRecords_Sexy numericalRecords;
    protected SexyUIManager uiManager;
    protected AudioManager_Sexy audioManager;
    
    [Header("å‹•ç•«é…ç½®")]
    public AnimationReferenceAsset[] playerAnimations;
    public AnimationReferenceAsset[] girlAnimations;
    
    [Header("ç¯€æ‹å‹•ç•«æ§åˆ¶")]
    protected RhythmicAnimationController rhythmController;
    
    public virtual void SetSharedSystems(NumericalRecords_Sexy numerical, SexyUIManager ui, AudioManager_Sexy audio)
    {
        numericalRecords = numerical;
        uiManager = ui;
        audioManager = audio;
        
        // åˆå§‹åŒ–ç¯€æ‹æ§åˆ¶å™¨
        InitializeRhythmController();
    }
    
    // ğŸµ åˆå§‹åŒ–å§¿å‹¢å°ˆå±¬çš„ç¯€æ‹æ§åˆ¶å™¨
    protected virtual void InitializeRhythmController()
    {
        rhythmController = gameObject.AddComponent<RhythmicAnimationController>();
        rhythmController.Initialize(playerSkeleton, girlSkeleton, GetPositionType());
        
        // è¨­å®šè©²å§¿å‹¢çš„ç¯€æ‹åƒæ•¸
        ConfigureRhythmParameters();
    }
    
    // ğŸ¬ åˆå§‹åŒ–å‹•ç•«ç³»çµ±
    public virtual void InitializeAnimations()
    {
        LoadAnimationAssets();
        SetDefaultAnimations();
        rhythmController.StartRhythm();
    }
    
    // ğŸ›‘ åœæ­¢æ‰€æœ‰å‹•ç•«
    public virtual void StopAllAnimations()
    {
        rhythmController.StopRhythm();
        playerSkeleton.AnimationState.ClearTracks();
        girlSkeleton.AnimationState.ClearTracks();
    }
    
    // ğŸ¯ é€éç¯€æ‹æ§åˆ¶å™¨æ’­æ”¾å‹•ç•«
    public virtual void RequestAnimation(BodyPart bodyPart, ActionType actionType, float intensity)
    {
        // ä¸ç›´æ¥æ’­æ”¾ï¼Œè€Œæ˜¯æäº¤çµ¦ç¯€æ‹æ§åˆ¶å™¨
        rhythmController.RecordAction(bodyPart, actionType, intensity);
    }
    
    protected abstract void LoadAnimationAssets();
    protected abstract void SetDefaultAnimations();
    protected abstract void ConfigureRhythmParameters();
    protected abstract AnimationReferenceAsset GetPlayerAnimation(string animationName);
    protected abstract AnimationReferenceAsset GetGirlAnimation(string animationName);
    protected abstract PositionType GetPositionType();
}
```

é€™å€‹æ¨¡çµ„åŒ–è¨­è¨ˆçš„å„ªé»ï¼š

### âœ… **æ¶æ§‹å„ªå‹¢**
- **æ¸…æ™°åˆ†é›¢**: æ¯å€‹å§¿å‹¢æœ‰ç¨ç«‹çš„Managerã€Controllerã€SpineManager
- **å…±äº«è³‡æº**: é€šç”¨çš„æ•¸å€¼ã€UIã€éŸ³æ•ˆç³»çµ±åœ¨å„å§¿å‹¢é–“å…±äº«
- **æ˜“æ–¼æ“´å±•**: æ–°å¢å§¿å‹¢åªéœ€å¯¦ç¾å°æ‡‰çš„ä¸‰å€‹çµ„ä»¶
- **ç¶­è­·æ€§**: å„å§¿å‹¢çš„é‚è¼¯äº’ä¸å¹²æ“¾ï¼Œä¾¿æ–¼èª¿è©¦å’Œä¿®æ”¹

---

## ğŸ­ æ ¸å¿ƒå§¿å‹¢ç³»çµ±æ¶æ§‹

### ğŸ¯ ä¸‰å¤§ä¸»è¦å§¿å‹¢è¨­è¨ˆ

æœ¬ç³»çµ±å¯¦ç¾ä¸‰ç¨®æ ¸å¿ƒå§¿å‹¢ï¼Œæ¯ç¨®å§¿å‹¢éƒ½æœ‰ç¨ç‰¹çš„æ§åˆ¶æ©Ÿåˆ¶å’Œæ•¸å€¼è¨ˆç®—æ–¹å¼ï¼š

#### 1ï¸âƒ£ **æ­£å¸¸ä½ (NormalPosition)**

```csharp
public class NormalPositionController : BasePositionController
{
    [Header("æ­£å¸¸ä½æ§åˆ¶")]
    public SliderController frictionSlider;      // æ‘©æ“¦é€Ÿåº¦æ§åˆ¶
    public SliderController fingerSlider;       // æ‰‹æŒ‡æŠ½æ’æ§åˆ¶  
    public SliderController mainActionSlider;   // ä¸»å‹•ä½œæŠ½æ’æ§åˆ¶
    
    public enum NormalPositionState
    {
        DefaultAction,    // é è¨­å‹•ä½œ - æ‘©æ“¦
        FingerAction,     // æŒ‡å‹•ä½œ - æ‰‹æŒ‡æŠ½æ’
        MainAction        // ä¸»èœå‹•ä½œ - æŠ½æ’
    }
    
    // ğŸ® é€Ÿåº¦æ§åˆ¶ (0-3 ç·šæ€§èª¿æ•´)
    public void OnSliderChanged(float value, ActionType actionType)
    {
        int speedLevel = Mathf.RoundToInt(value * 3);
        
        switch (actionType)
        {
            case ActionType.Default:
                ApplyFrictionSpeed(speedLevel);      // æ‘©æ“¦é€Ÿåº¦
                break;
            case ActionType.Finger:
                ApplyFingerSpeed(speedLevel);        // æ‰‹æŒ‡æŠ½æ’é€Ÿåº¦
                break;
            case ActionType.Main:
                ApplyMainActionSpeed(speedLevel);    // ä¸»å‹•ä½œæŠ½æ’é€Ÿåº¦
                break;
        }
    }
}
```

#### 2ï¸âƒ£ **å¥³ä¸Šä½ (CowgirlPosition)**

```csharp
public class CowgirlPositionController : BasePositionController
{
    [Header("å¥³ä¸Šä½æ§åˆ¶")]
    public SliderController frictionSlider;      // æ‘©æ“¦é€Ÿåº¦æ§åˆ¶
    public SliderController mainActionSlider;   // ä¸»å‹•ä½œæ§åˆ¶ (-3 ~ +3)
    
    public enum CowgirlPositionState
    {
        DefaultAction,    // é è¨­å‹•ä½œ - æ‘©æ“¦
        MainAction        // ä¸»èœå‹•ä½œ - é›™å‘æŠ½æ’æ§åˆ¶
    }
    
    // ğŸ® é›™å‘æ§åˆ¶ç³»çµ± (-3 ~ 0 ~ +3)
    public void OnMainActionSliderChanged(float value)
    {
        // value ç¯„åœ: -1.0f ~ +1.0f
        float mappedValue = value * 3f;  // æ˜ å°„åˆ° -3 ~ +3
        
        if (Mathf.Abs(mappedValue) < 0.1f)
        {
            // ä¸­é–“å€åŸŸ - åœæ­¢å‹•ä½œ
            SetActionState(ActionState.Idle);
            currentIntensity = 0f;
        }
        else if (mappedValue < 0)
        {
            // å·¦å´ - å¥³æ–¹ä¸»å°å‹•ä½œ
            SetActionState(ActionState.GirlDriven);
            currentIntensity = Mathf.Abs(mappedValue);
            animationSpeed = currentIntensity / 3f;
        }
        else
        {
            // å³å´ - ç”·æ–¹ä¸»å°å‹•ä½œ  
            SetActionState(ActionState.PlayerDriven);
            currentIntensity = mappedValue;
            animationSpeed = currentIntensity / 3f;
        }
        
        ApplyAnimationAndStimulation();
    }
}
```

#### 3ï¸âƒ£ **èƒŒå¾Œä½ (DoggystylePosition)**

```csharp
public class DoggystylePositionController : BasePositionController
{
    [Header("èƒŒå¾Œä½æ§åˆ¶")]
    public SliderController frictionSlider;      // æ‘©æ“¦é€Ÿåº¦æ§åˆ¶
    public SliderController mainActionSlider;   // ä¸»å‹•ä½œæ§åˆ¶ (-3 ~ +3)
    
    public enum DoggystylePositionState
    {
        DefaultAction,    // é è¨­å‹•ä½œ - æ‘©æ“¦
        MainAction        // ä¸»èœå‹•ä½œ - é›™å‘æŠ½æ’æ§åˆ¶
    }
    
    // ğŸ® èˆ‡å¥³ä¸Šä½ç›¸åŒçš„é›™å‘æ§åˆ¶æ©Ÿåˆ¶
    public void OnMainActionSliderChanged(float value)
    {
        float mappedValue = value * 3f;
        
        if (Mathf.Abs(mappedValue) < 0.1f)
        {
            SetActionState(ActionState.Idle);
            currentIntensity = 0f;
        }
        else if (mappedValue < 0)
        {
            SetActionState(ActionState.GirlDriven);    // å¥³æ–¹ä¸»å°
            currentIntensity = Mathf.Abs(mappedValue);
        }
        else
        {
            SetActionState(ActionState.PlayerDriven);  // ç”·æ–¹ä¸»å°
            currentIntensity = mappedValue;
        }
        
        ApplyBackPositionAnimation();
    }
}
```

### ğŸ”„ å§¿å‹¢åˆ‡æ›ç³»çµ±

```csharp
public class PositionSwitchManager : MonoBehaviour
{
    [Header("å§¿å‹¢ç®¡ç†")]
    public NormalPositionController normalPosition;
    public CowgirlPositionController cowgirlPosition;
    public DoggystylePositionController doggystylePosition;
    
    [Header("æ•¸å€¼æŒçºŒæ€§")]
    public NumericalRecords_Sexy sharedNumericalRecords;  // å…±äº«æ•¸å€¼è¨˜éŒ„
    
    public enum PositionType
    {
        Normal,      // æ­£å¸¸ä½
        Cowgirl,     // å¥³ä¸Šä½  
        Doggystyle   // èƒŒå¾Œä½
    }
    
    public PositionType currentPosition = PositionType.Normal;
    
    // ğŸ¯ å§¿å‹¢åˆ‡æ›æ ¸å¿ƒæ–¹æ³•
    public void SwitchPosition(PositionType newPosition)
    {
        // ä¿å­˜ç•¶å‰å§¿å‹¢çš„æ•¸å€¼ç‹€æ…‹
        SaveCurrentPositionState();
        
        // åˆ‡æ›åˆ°æ–°å§¿å‹¢
        DeactivateCurrentPosition();
        currentPosition = newPosition;
        ActivateNewPosition(newPosition);
        
        // æ¢å¾©æ•¸å€¼é€£è²«æ€§
        RestoreNumericalContinuity();
        
        // æ›´æ–°UIé¡¯ç¤º
        UpdatePositionUI();
    }
    
    // ğŸ’¾ æ•¸å€¼é€£è²«æ€§ä¿è­‰
    void SaveCurrentPositionState()
    {
        // ä¿å­˜ç•¶å‰æ•¸å€¼åˆ°å…±äº«è¨˜éŒ„
        var currentData = new PositionStateData
        {
            playerDelight = sharedNumericalRecords.playerDelight,
            girlDelight = sharedNumericalRecords.girlDelight,
            playerStamina = sharedNumericalRecords.playerStamina,
            girlStamina = sharedNumericalRecords.girlStamina,
            currentSensitivity = sharedNumericalRecords.slutty * sharedNumericalRecords.lust
        };
        
        PlayerPrefs.SetString($"PositionState_{currentPosition}", JsonUtility.ToJson(currentData));
    }
    
    void RestoreNumericalContinuity()
    {
        // ç¢ºä¿æ•¸å€¼åœ¨å§¿å‹¢åˆ‡æ›å¾Œä¿æŒé€£çºŒ
        // ä¸é‡ç½®ä»»ä½•æ•¸å€¼ï¼Œä¿æŒéŠæˆ²é€²è¡Œçš„é€£è²«æ„Ÿ
        
        // å¯é¸ï¼šæ·»åŠ å§¿å‹¢åˆ‡æ›çš„å°å¹…æ•¸å€¼èª¿æ•´
        ApplyPositionSwitchEffects();
    }
    
    // âš¡ å§¿å‹¢åˆ‡æ›æ•ˆæœ
    void ApplyPositionSwitchEffects()
    {
        // å§¿å‹¢åˆ‡æ›å¯èƒ½å¸¶ä¾†çš„æ•¸å€¼å¾®èª¿
        switch (currentPosition)
        {
            case PositionType.Cowgirl:
                // å¥³ä¸Šä½å¯èƒ½å¢åŠ å¥³æ–¹çš„ä¸»å‹•æ€§
                sharedNumericalRecords.girlDelight += 2f;
                break;
                
            case PositionType.Doggystyle:
                // èƒŒå¾Œä½å¯èƒ½å¢åŠ åˆºæ¿€æ„Ÿ
                sharedNumericalRecords.slutty *= 1.1f;
                break;
                
            case PositionType.Normal:
                // æ­£å¸¸ä½ä¿æŒå¹³è¡¡
                break;
        }
    }
}
```

### ğŸ“Š å§¿å‹¢å°ˆå±¬æ•¸å€¼è¨ˆç®—

```csharp
public class PositionSpecificCalculations : MonoBehaviour
{
    // ğŸ¯ æ ¹æ“šä¸åŒå§¿å‹¢èª¿æ•´åˆºæ¿€è¨ˆç®—
    public float CalculateStimulationByPosition(PositionType position, float baseStimulation, float intensity)
    {
        float positionMultiplier = 1.0f;
        
        switch (position)
        {
            case PositionType.Normal:
                // æ­£å¸¸ä½ - æ¨™æº–åˆºæ¿€å€¼
                positionMultiplier = 1.0f;
                
                // æ‰‹æŒ‡å‹•ä½œæœ‰ç‰¹æ®ŠåŠ æˆ
                if (IsFingerActionActive())
                {
                    positionMultiplier += 0.3f;
                }
                break;
                
            case PositionType.Cowgirl:
                // å¥³ä¸Šä½ - å¥³æ–¹ä¸»å°æ™‚åˆºæ¿€å€¼æ›´é«˜
                if (IsGirlDrivenAction())
                {
                    positionMultiplier = 1.4f;
                }
                else
                {
                    positionMultiplier = 1.1f;
                }
                break;
                
            case PositionType.Doggystyle:
                // èƒŒå¾Œä½ - æ•´é«”åˆºæ¿€å€¼æå‡
                positionMultiplier = 1.3f;
                
                // é›™æ–¹é…åˆæ™‚é¡å¤–åŠ æˆ
                if (IsBothParticipating())
                {
                    positionMultiplier += 0.2f;
                }
                break;
        }
        
        return baseStimulation * positionMultiplier * (intensity / 3f);
    }
}
```

### ğŸµ å§¿å‹¢å°ˆå±¬ç¯€æ‹æ§åˆ¶å™¨

æ¯å€‹å§¿å‹¢éƒ½éœ€è¦ç¨ç«‹çš„ç¯€æ‹æ§åˆ¶å™¨ï¼Œå› ç‚ºï¼š
- **ä¸åŒç¯€æ‹é–“éš”**: æ­£å¸¸ä½å¯èƒ½æ˜¯1.5ç§’ï¼Œå¥³ä¸Šä½å¯èƒ½æ˜¯2.0ç§’
- **ä¸åŒè»Œé“é…ç½®**: å„å§¿å‹¢ä½¿ç”¨çš„èº«é«”éƒ¨ä½å’Œå‹•ç•«è»Œé“ä¸åŒ
- **ä¸åŒå‹•ä½œé‚è¼¯**: æ¯å€‹å§¿å‹¢çš„å‹•ä½œçµ„åˆå’Œè½‰æ›è¦å‰‡ä¸åŒ

#### ğŸ¯ å§¿å‹¢å°ˆå±¬ç¯€æ‹æ§åˆ¶å¯¦ç¾

```csharp
// æ­£å¸¸ä½ç¯€æ‹æ§åˆ¶å™¨
public class NormalPositionRhythmController : RhythmicAnimationController
{
    protected override void ConfigureRhythmParameters()
    {
        beatInterval = 1.5f;  // æ­£å¸¸ä½ç¯€æ‹è¼ƒå¿«
        
        // è¨­å®šæ­£å¸¸ä½çš„è»Œé“é…ç½®
        trackMapping = new Dictionary<BodyPart, int>
        {
            { BodyPart.Chest, 0 },
            { BodyPart.LeftHand, 1 },
            { BodyPart.RightHand, 2 },
            { BodyPart.Finger, 3 },      // æ­£å¸¸ä½ç‰¹æœ‰
            { BodyPart.MainAction, 4 }   // æ­£å¸¸ä½ç‰¹æœ‰
        };
    }
    
    protected override Dictionary<string, AnimationReferenceAsset> LoadPositionAnimations()
    {
        return new Dictionary<string, AnimationReferenceAsset>
        {
            { "normal_friction_0", normalFriction0 },
            { "normal_friction_1", normalFriction1 },
            { "normal_finger_0", normalFinger0 },
            { "normal_main_0", normalMain0 },
            // ... æ›´å¤šæ­£å¸¸ä½å‹•ç•«
        };
    }
}

// å¥³ä¸Šä½ç¯€æ‹æ§åˆ¶å™¨  
public class CowgirlPositionRhythmController : RhythmicAnimationController
{
    protected override void ConfigureRhythmParameters()
    {
        beatInterval = 2.0f;  // å¥³ä¸Šä½ç¯€æ‹è¼ƒæ…¢ï¼Œæ›´æœ‰ç¯€å¥æ„Ÿ
        
        // å¥³ä¸Šä½çš„è»Œé“é…ç½® - æ²’æœ‰æ‰‹æŒ‡è»Œé“
        trackMapping = new Dictionary<BodyPart, int>
        {
            { BodyPart.Chest, 0 },
            { BodyPart.LeftHand, 1 },
            { BodyPart.RightHand, 2 },
            { BodyPart.MainAction, 3 },    // é›™å‘æ§åˆ¶
            { BodyPart.GirlAction, 4 }     // å¥³ä¸Šä½ç‰¹æœ‰ - å¥³æ–¹ä¸»å°å‹•ä½œ
        };
    }
    
    protected override Dictionary<string, AnimationReferenceAsset> LoadPositionAnimations()
    {
        return new Dictionary<string, AnimationReferenceAsset>
        {
            { "cowgirl_friction_0", cowgirlFriction0 },
            { "cowgirl_player_1", cowgirlPlayer1 },
            { "cowgirl_girl_1", cowgirlGirl1 },
            // ... æ›´å¤šå¥³ä¸Šä½å‹•ç•«
        };
    }
    
    // å¥³ä¸Šä½ç‰¹æœ‰çš„é›™å‘æ§åˆ¶é‚è¼¯
    protected override void ProcessMainActionControl(float value)
    {
        if (Mathf.Abs(value) < 0.1f)
        {
            // ä¸­é–“å€åŸŸ - æš«åœ
            RecordAction(BodyPart.MainAction, ActionType.Idle, 0f);
        }
        else if (value < 0)
        {
            // å·¦å´ - å¥³æ–¹ä¸»å°
            RecordAction(BodyPart.GirlAction, ActionType.Thrust, Mathf.Abs(value));
        }
        else
        {
            // å³å´ - ç”·æ–¹ä¸»å°  
            RecordAction(BodyPart.MainAction, ActionType.Thrust, value);
        }
    }
}

// èƒŒå¾Œä½ç¯€æ‹æ§åˆ¶å™¨
public class DoggystylePositionRhythmController : RhythmicAnimationController
{
    protected override void ConfigureRhythmParameters()
    {
        beatInterval = 1.8f;  // èƒŒå¾Œä½ä¸­ç­‰ç¯€æ‹
        
        // èƒŒå¾Œä½è»Œé“é…ç½® - å¼·èª¿èº«é«”å‹•ä½œ
        trackMapping = new Dictionary<BodyPart, int>
        {
            { BodyPart.Chest, 0 },
            { BodyPart.LeftHand, 1 },
            { BodyPart.RightHand, 2 },
            { BodyPart.MainAction, 3 },
            { BodyPart.HipAction, 4 }      // èƒŒå¾Œä½ç‰¹æœ‰ - è…°éƒ¨å‹•ä½œ
        };
    }
    
    protected override Dictionary<string, AnimationReferenceAsset> LoadPositionAnimations()
    {
        return new Dictionary<string, AnimationReferenceAsset>
        {
            { "doggy_friction_0", doggyFriction0 },
            { "doggy_thrust_1", doggyThrust1 },
            { "doggy_hip_1", doggyHip1 },
            // ... æ›´å¤šèƒŒå¾Œä½å‹•ç•«
        };
    }
}
```

#### ğŸ—ï¸ å§¿å‹¢ç®¡ç†å™¨æ•´åˆç¯€æ‹æ§åˆ¶å™¨

```csharp
public class NormalPositionManager : BasePositionManager
{
    [Header("æ­£å¸¸ä½å°ˆç”¨çµ„ä»¶")]
    public NormalPlayerController normalPlayerController;
    public NormalSpineManager normalSpineManager;
    public NormalPositionRhythmController rhythmController;  // å°ˆå±¬ç¯€æ‹æ§åˆ¶å™¨
    
    void Awake()
    {
        playerController = normalPlayerController;
        spineManager = normalSpineManager;
    }
    
    public override void OnPositionEnter()
    {
        base.OnPositionEnter();
        
        // å•Ÿå‹•æ­£å¸¸ä½çš„ç¯€æ‹ç³»çµ±
        rhythmController.StartRhythm();
        
        // è¨­å®šæ­£å¸¸ä½ç‰¹æœ‰çš„UI
        uiManager.ShowNormalPositionControls();
        uiManager.ShowBeatIndicator(rhythmController.beatInterval);
    }
    
    public override void OnPositionExit()
    {
        // åœæ­¢ç¯€æ‹æ§åˆ¶å™¨
        rhythmController.StopRhythm();
        
        base.OnPositionExit();
    }
}
```

### ğŸµ ç¯€æ‹åŒæ­¥å‹•ç•«ç³»çµ±

#### ğŸ¯ å•é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆ

**å•é¡Œ**: ç©å®¶å¿«é€Ÿæ“ä½œå°è‡´å‹•ç•«æŠ½æï¼Œç ´å£éŠæˆ²é«”é©—  
**è§£æ±º**: ç¯€æ‹å‘¨æœŸ + ç‹€æ…‹ç·©è¡ + å¤šè»Œé“å¹³æ»‘éæ¸¡

```csharp
public class RhythmicAnimationController : MonoBehaviour
{
    [Header("ç¯€æ‹æ§åˆ¶")]
    public float beatInterval = 1.5f;          // ä¸€å€‹ç¯€æ‹å‘¨æœŸæ™‚é•·ï¼ˆç§’ï¼‰
    public float currentBeatProgress = 0f;     // ç•¶å‰ç¯€æ‹é€²åº¦ (0-1)
    
    [Header("ç‹€æ…‹ç·©è¡")]
    private Dictionary<BodyPart, List<ActionCommand>> pendingActions = new Dictionary<BodyPart, List<ActionCommand>>();
    private Dictionary<BodyPart, ActionState> currentStates = new Dictionary<BodyPart, ActionState>();
    private Dictionary<BodyPart, ActionState> targetStates = new Dictionary<BodyPart, ActionState>();
    
    [Header("å¤šè»Œé“å‹•ç•«")]
    public SkeletonAnimation playerSkeleton;
    public SkeletonAnimation girlSkeleton;
    private const int CHEST_TRACK = 0;
    private const int HAND_LEFT_TRACK = 1;
    private const int HAND_RIGHT_TRACK = 2;
    private const int BODY_TRACK = 3;
    
    void Update()
    {
        UpdateBeatProgress();
        
        if (IsBeatComplete())
        {
            ProcessPendingActions();    // è™•ç†ç·©è¡çš„æ“ä½œ
            ApplyStateTransitions();    // åŸ·è¡Œç‹€æ…‹è½‰æ›
            ResetBeatCycle();          // é‡ç½®å‘¨æœŸ
        }
    }
    
    // ğŸµ ç¯€æ‹é€²åº¦æ›´æ–°
    void UpdateBeatProgress()
    {
        currentBeatProgress += Time.deltaTime / beatInterval;
        
        // æä¾›è¦–è¦ºåé¥‹ - ç¯€æ‹æŒ‡ç¤ºå™¨
        UIManager.UpdateBeatIndicator(currentBeatProgress);
    }
    
    // âœ… æª¢æŸ¥ç¯€æ‹æ˜¯å¦å®Œæˆ
    bool IsBeatComplete()
    {
        return currentBeatProgress >= 1.0f;
    }
    
    // ğŸ“ ç©å®¶æ“ä½œè¨˜éŒ„ï¼ˆä¸ç«‹å³åŸ·è¡Œï¼‰
    public void RecordAction(BodyPart bodyPart, ActionType actionType, float intensity)
    {
        var command = new ActionCommand
        {
            bodyPart = bodyPart,
            actionType = actionType,
            intensity = intensity,
            timestamp = Time.time
        };
        
        if (!pendingActions.ContainsKey(bodyPart))
        {
            pendingActions[bodyPart] = new List<ActionCommand>();
        }
        
        pendingActions[bodyPart].Add(command);
        
        // æä¾›å³æ™‚è¦–è¦ºåé¥‹ï¼ˆä½†ä¸æ”¹è®Šå‹•ç•«ï¼‰
        ShowActionPreview(bodyPart, actionType, intensity);
    }
    
    // ğŸ”„ è™•ç†ç·©è¡å€çš„æ“ä½œ
    void ProcessPendingActions()
    {
        foreach (var bodyPart in System.Enum.GetValues(typeof(BodyPart)).Cast<BodyPart>())
        {
            if (pendingActions.ContainsKey(bodyPart) && pendingActions[bodyPart].Count > 0)
            {
                // å–æœ€å¾Œä¸€å€‹æ“ä½œä½œç‚ºæœ€çµ‚ç‹€æ…‹
                var finalAction = pendingActions[bodyPart].Last();
                targetStates[bodyPart] = ConvertToActionState(finalAction);
                
                // æ¸…ç©ºè©²éƒ¨ä½çš„ç·©è¡å€
                pendingActions[bodyPart].Clear();
                
                Debug.Log($"ç¯€æ‹å®Œæˆ - {bodyPart}: åŸ·è¡Œæœ€çµ‚ç‹€æ…‹ {finalAction.actionType}");
            }
        }
    }
    
    // ğŸ¬ åŸ·è¡Œç‹€æ…‹è½‰æ›ï¼ˆå¹³æ»‘éæ¸¡ï¼‰
    void ApplyStateTransitions()
    {
        foreach (var kvp in targetStates)
        {
            BodyPart bodyPart = kvp.Key;
            ActionState targetState = kvp.Value;
            ActionState currentState = currentStates.GetValueOrDefault(bodyPart, ActionState.Idle);
            
            if (!currentState.Equals(targetState))
            {
                // åŸ·è¡Œå¹³æ»‘è½‰æ›
                StartCoroutine(SmoothTransition(bodyPart, currentState, targetState));
                currentStates[bodyPart] = targetState;
            }
        }
        
        targetStates.Clear();
    }
    
    // ğŸŒŠ å¹³æ»‘å‹•ç•«è½‰æ›
    IEnumerator SmoothTransition(BodyPart bodyPart, ActionState fromState, ActionState toState)
    {
        int trackIndex = GetTrackIndex(bodyPart);
        float transitionDuration = 0.3f;  // è½‰æ›æ™‚é–“
        
        // æ’­æ”¾éæ¸¡å‹•ç•«ï¼ˆå¦‚æœéœ€è¦ï¼‰
        if (HasTransitionAnimation(fromState, toState))
        {
            var transitionAnim = GetTransitionAnimation(fromState, toState);
            playerSkeleton.AnimationState.SetAnimation(trackIndex, transitionAnim, false);
            yield return new WaitForSeconds(transitionDuration);
        }
        
        // æ’­æ”¾ç›®æ¨™å‹•ç•«
        var targetAnim = GetAnimationForState(bodyPart, toState);
        if (targetAnim != null)
        {
            playerSkeleton.AnimationState.SetAnimation(trackIndex, targetAnim, true);
            playerSkeleton.AnimationState.GetCurrent(trackIndex).TimeScale = toState.speed;
        }
        
        // åŒæ­¥æ’­æ”¾å°æ‡‰çš„éŸ³æ•ˆ
        AudioManager.PlayTransitionSound(bodyPart, toState);
    }
    
    // ğŸ“º å‹•ä½œé è¦½ï¼ˆå³æ™‚è¦–è¦ºåé¥‹ï¼‰
    void ShowActionPreview(BodyPart bodyPart, ActionType actionType, float intensity)
    {
        // åœ¨UIä¸Šé¡¯ç¤ºå³å°‡åŸ·è¡Œçš„å‹•ä½œï¼Œä½†ä¸æ”¹è®Šå¯¦éš›å‹•ç•«
        UIManager.ShowActionPreview(bodyPart, actionType, intensity, GetRemainingBeatTime());
        
        // å¯é¸ï¼šè¼•å¾®çš„è¦–è¦ºæ•ˆæœæç¤º
        SpawnActionHint(bodyPart, actionType);
    }
    
    float GetRemainingBeatTime()
    {
        return (1.0f - currentBeatProgress) * beatInterval;
    }
    
    void ResetBeatCycle()
    {
        currentBeatProgress = 0f;
        UIManager.ClearActionPreviews();  // æ¸…é™¤é è¦½æ•ˆæœ
    }
}
```

#### ğŸµ ç¯€æ‹å‘¨æœŸç‹€æ…‹æ©Ÿ

```csharp
public class BeatCycleStateMachine : MonoBehaviour
{
    public enum BeatPhase
    {
        Preparation,    // æº–å‚™éšæ®µ (0-25%)
        Action,         // å‹•ä½œéšæ®µ (25%-75%)  
        Transition,     // è½‰æ›éšæ®µ (75%-100%)
    }
    
    public BeatPhase currentPhase;
    
    void Update()
    {
        float progress = rhythmController.currentBeatProgress;
        
        BeatPhase newPhase = progress switch
        {
            < 0.25f => BeatPhase.Preparation,
            < 0.75f => BeatPhase.Action,
            _ => BeatPhase.Transition
        };
        
        if (newPhase != currentPhase)
        {
            OnPhaseChanged(currentPhase, newPhase);
            currentPhase = newPhase;
        }
    }
    
    void OnPhaseChanged(BeatPhase from, BeatPhase to)
    {
        switch (to)
        {
            case BeatPhase.Preparation:
                // æº–å‚™ä¸‹ä¸€è¼ªå‹•ä½œï¼Œå…è¨±ç©å®¶è¼¸å…¥
                UIManager.SetInputEnabled(true);
                break;
                
            case BeatPhase.Action:
                // å‹•ä½œåŸ·è¡Œä¸­ï¼Œè¼¸å…¥æœƒè¢«ç·©è¡
                ShowCurrentActions();
                break;
                
            case BeatPhase.Transition:
                // å³å°‡è½‰æ›ï¼Œåœæ­¢æ¥å—æ–°è¼¸å…¥
                UIManager.SetInputEnabled(false);
                PrepareTransition();
                break;
        }
    }
}
```

#### ğŸ”§ æ“ä½œç·©è¡ç³»çµ±

```csharp
[System.Serializable]
public class ActionCommand
{
    public BodyPart bodyPart;
    public ActionType actionType;
    public float intensity;
    public float timestamp;
}

[System.Serializable] 
public class ActionState
{
    public ActionType actionType;
    public float speed;
    public float intensity;
    
    public bool Equals(ActionState other)
    {
        return actionType == other.actionType && 
               Mathf.Approximately(speed, other.speed) && 
               Mathf.Approximately(intensity, other.intensity);
    }
}

public class ActionBuffer : MonoBehaviour
{
    // ğŸ“‹ æª¢æŸ¥é»A~Bä¹‹é–“çš„æ“ä½œè¨˜éŒ„ç¯„ä¾‹
    private void LogActionSequence()
    {
        // å‡è¨­åœ¨ä¸€å€‹ç¯€æ‹å‘¨æœŸå…§ç©å®¶çš„æ“ä½œï¼š
        var actions = new List<ActionCommand>
        {
            new ActionCommand { bodyPart = BodyPart.LeftHand, actionType = ActionType.Grasp, timestamp = 0.1f },
            new ActionCommand { bodyPart = BodyPart.RightHand, actionType = ActionType.Touch, timestamp = 0.3f },
            new ActionCommand { bodyPart = BodyPart.Chest, actionType = ActionType.Press, timestamp = 0.5f },
            new ActionCommand { bodyPart = BodyPart.Chest, actionType = ActionType.Caress, timestamp = 0.7f },
            new ActionCommand { bodyPart = BodyPart.Chest, actionType = ActionType.Release, timestamp = 0.9f }
        };
        
        // ç¯€æ‹çµæŸæ™‚çš„æœ€çµ‚ç‹€æ…‹ï¼š
        // LeftHand: Grasp (æœ€å¾Œæ“ä½œ)
        // RightHand: Touch (æœ€å¾Œæ“ä½œ)  
        // Chest: Release (æœ€å¾Œæ“ä½œ)
        
        Debug.Log("ç¯€æ‹é€±æœŸå®Œæˆï¼ŒåŸ·è¡Œæœ€çµ‚ç‹€æ…‹çµ„åˆ");
    }
}
```

### ğŸ® UIæ§åˆ¶æ˜ å°„è¡¨

| å§¿å‹¢ | æ§åˆ¶é …ç›® | æ»‘æ¡¿ç¯„åœ | æ§åˆ¶é‚è¼¯ | å‹•ç•«æ•ˆæœ | ç¯€æ‹åŒæ­¥ |
|------|----------|----------|----------|----------|----------|
| **æ­£å¸¸ä½** | æ‘©æ“¦é€Ÿåº¦ | 0-3 ç·šæ€§ | æ¨™æº–é€Ÿåº¦æ§åˆ¶ | friction_0~3 | âœ… å‘¨æœŸæ›´æ–° |
|  | æ‰‹æŒ‡æŠ½æ’ | 0-3 ç·šæ€§ | æ‰‹æŒ‡å°ˆç”¨å‹•ä½œ | finger_0~3 | âœ… å‘¨æœŸæ›´æ–° |
|  | ä¸»å‹•ä½œæŠ½æ’ | 0-3 ç·šæ€§ | ä¸»è¦æŠ½æ’å‹•ä½œ | main_0~3 | âœ… å‘¨æœŸæ›´æ–° |
| **å¥³ä¸Šä½** | æ‘©æ“¦é€Ÿåº¦ | 0-3 ç·šæ€§ | æ¨™æº–é€Ÿåº¦æ§åˆ¶ | cowgirl_friction_0~3 | âœ… å‘¨æœŸæ›´æ–° |
|  | ä¸»å‹•ä½œ | -3~0~3 é›™å‘ | ä¸­é–“åœæ­¢ï¼Œå·¦å¥³å³ç”· | cowgirl_girl/player_1~3 | âœ… å‘¨æœŸæ›´æ–° |
| **èƒŒå¾Œä½** | æ‘©æ“¦é€Ÿåº¦ | 0-3 ç·šæ€§ | æ¨™æº–é€Ÿåº¦æ§åˆ¶ | doggy_friction_0~3 | âœ… å‘¨æœŸæ›´æ–° |
|  | ä¸»å‹•ä½œ | -3~0~3 é›™å‘ | ä¸­é–“åœæ­¢ï¼Œå·¦å¥³å³ç”· | doggy_girl/player_1~3 | âœ… å‘¨æœŸæ›´æ–° |

---

## ğŸ”„ å®Œæ•´ç³»çµ±æµç¨‹èˆ‡æ•¸æ“šæµå‹•

### ğŸ® æ•´é«”æµç¨‹æ¦‚è¦½

```
ğŸ¯ é€²å…¥æˆäººå…§å®¹æ¨¡å¼
    â†“
ğŸ­ å§¿å‹¢é¸æ“‡èˆ‡åˆå§‹åŒ–  
    â†“
ğŸµ ç¯€æ‹å‘¨æœŸå¾ªç’° (ç©å®¶äº’å‹•æ ¸å¿ƒ)
    â†“
ğŸ“Š æ•¸å€¼ç´¯ç©èˆ‡ç‹€æ…‹æª¢æ¸¬
    â†“
ğŸ† çµç®—èˆ‡æ•¸æ“šä¿å­˜
```

### ğŸ“‹ è©³ç´°æµç¨‹åˆ†æ

#### ğŸš€ **éšæ®µ1: ç³»çµ±å•Ÿå‹•èˆ‡åˆå§‹åŒ–**

```csharp
// æµç¨‹: ä¸»éŠæˆ² â†’ æˆäººå…§å®¹æ¨¡å¼
void EnterSexyMode()
{
    // 1. æª¢æŸ¥è§£é–æ¢ä»¶
    if (!IntimacyUnlockSystem.CheckUnlockConditions())
    {
        ShowUnlockRequirements();
        return;
    }
    
    // 2. å•Ÿå‹•æˆäººå…§å®¹ä¸»ç®¡ç†å™¨
    SexyGameManager.Instance.Initialize();
    
    // 3. åˆå§‹åŒ–å…±äº«ç³»çµ±
    sharedNumericalRecords.ResetToInitialState();
    sharedUIManager.InitializeUI();
    audioManager.LoadSexyAudioBank();
    
    // 4. åˆ‡æ›åˆ°é è¨­å§¿å‹¢ (æ­£å¸¸ä½)
    SexyGameManager.Instance.SwitchToPosition(PositionType.Normal);
}
```

**æ•¸æ“šæµå‹•**: ä¸»éŠæˆ²æ•¸æ“š(å¥½æ„Ÿåº¦ã€æ™‚é–“) â†’ è§£é–æª¢æŸ¥ â†’ åˆå§‹åŒ–æˆäººå…§å®¹ç³»çµ±

#### ğŸ­ **éšæ®µ2: å§¿å‹¢åˆ‡æ›èˆ‡ç¯€æ‹å•Ÿå‹•**

```csharp
// æµç¨‹: å§¿å‹¢ç®¡ç†å™¨å•Ÿå‹•
void SwitchToPosition(PositionType newPosition)
{
    // 1. åœç”¨ç•¶å‰å§¿å‹¢çš„æ‰€æœ‰ç³»çµ±
    currentPositionManager?.OnPositionExit();
    
    // 2. æ•¸å€¼ç³»çµ±ä¿æŒé€£çºŒæ€§ (é‡è¦!)
    // ä¸é‡ç½®ä»»ä½•æ•¸å€¼ï¼Œç¢ºä¿éŠæˆ²é€£è²«æ€§
    
    // 3. å•Ÿå‹•æ–°å§¿å‹¢çš„ç³»çµ±
    var newManager = GetPositionManager(newPosition);
    newManager.OnPositionEnter();
    
    // 4. å•Ÿå‹•æ–°çš„ç¯€æ‹æ§åˆ¶å™¨
    newManager.rhythmController.StartRhythm();
    
    // 5. UIåˆ‡æ›åˆ°å°æ‡‰å§¿å‹¢çš„æ§åˆ¶ä»‹é¢
    sharedUIManager.SwitchToPositionUI(newPosition);
}
```

**æ•¸æ“šæµå‹•**: å§¿å‹¢åˆ‡æ›æŒ‡ä»¤ â†’ ä¿å­˜ç•¶å‰æ•¸å€¼ â†’ åˆ‡æ›ç®¡ç†å™¨ â†’ æ¢å¾©æ•¸å€¼ â†’ å•Ÿå‹•æ–°ç¯€æ‹

#### ğŸµ **éšæ®µ3: ç¯€æ‹å‘¨æœŸæ ¸å¿ƒå¾ªç’° (ç©å®¶äº’å‹•)**

é€™æ˜¯æ•´å€‹ç³»çµ±çš„æ ¸å¿ƒï¼Œæ•¸æ“šæµå‹•æœ€è¤‡é›œçš„éƒ¨åˆ†ï¼š

```csharp
// æ¯å€‹ç¯€æ‹å‘¨æœŸ (1.5-2.0ç§’) çš„å®Œæ•´æµç¨‹
void BeatCycleFlow()
{
    // === æº–å‚™éšæ®µ (0-25%) ===
    // ç©å®¶å¯ä»¥è‡ªç”±æ“ä½œï¼Œæ‰€æœ‰è¼¸å…¥è¢«è¨˜éŒ„ä½†ä¸åŸ·è¡Œ
    
    void OnPlayerInput(BodyPart bodyPart, ActionType action, float intensity)
    {
        // 1. æ¥æ”¶ç©å®¶è¼¸å…¥
        PlayerController.OnButtonClick() / OnSliderChange()
            â†“
        // 2. æäº¤çµ¦ç¯€æ‹æ§åˆ¶å™¨ (ä¸ç«‹å³åŸ·è¡Œ!)
        rhythmController.RecordAction(bodyPart, action, intensity)
            â†“
        // 3. é¡¯ç¤ºæ“ä½œé è¦½ (å³æ™‚åé¥‹)
        UIManager.ShowActionPreview(bodyPart, action, remainingBeatTime)
            â†“
        // 4. å­˜å…¥ç·©è¡å€ç­‰å¾…çµ±ä¸€è™•ç†
        pendingActions[bodyPart].Add(new ActionCommand(...))
    }
    
    // === å‹•ä½œéšæ®µ (25-75%) ===
    // æ’­æ”¾ç•¶å‰å‹•ä½œï¼Œç¹¼çºŒæ¥æ”¶å’Œç·©è¡ç©å®¶è¼¸å…¥
    
    // === è½‰æ›éšæ®µ (75-100%) ===
    // ç¯€æ‹å³å°‡çµæŸï¼Œæº–å‚™åŸ·è¡Œæ‰€æœ‰ç·©è¡çš„æ“ä½œ
    
    void OnBeatComplete()
    {
        // 1. è™•ç†ç·©è¡å€ - å–æ¯å€‹èº«é«”éƒ¨ä½çš„æœ€å¾Œæ“ä½œ
        foreach (var bodyPart in pendingActions.Keys)
        {
            var finalAction = pendingActions[bodyPart].Last();
            targetStates[bodyPart] = ConvertToActionState(finalAction);
        }
        
        // 2. åŸ·è¡Œå‹•ç•«è½‰æ› (å¤šè»Œé“å¹³æ»‘éæ¸¡)
        ApplyStateTransitions()
            â†“
        // 3. è¨ˆç®—æ•¸å€¼å½±éŸ¿
        CalculateStimulationEffects()
            â†“
        // 4. æ›´æ–°å…±äº«æ•¸å€¼ç³»çµ±
        sharedNumericalRecords.ApplyStimulation(...)
            â†“
        // 5. æª¢æ¸¬é«˜æ½®ç‹€æ…‹
        CheckOrgasmConditions()
            â†“
        // 6. æ›´æ–°UIé¡¯ç¤º
        sharedUIManager.UpdateAllValues()
            â†“
        // 7. æ’­æ”¾éŸ³æ•ˆ
        audioManager.PlayActionAudio(...)
            â†“
        // 8. é‡ç½®ç¯€æ‹å‘¨æœŸï¼Œé–‹å§‹ä¸‹ä¸€è¼ª
        ResetBeatCycle()
    }
}
```

**æ•¸æ“šæµå‹•**: ç©å®¶è¼¸å…¥ â†’ æ“ä½œç·©è¡ â†’ ç¯€æ‹çµ±ä¸€è™•ç† â†’ å‹•ç•«+æ•¸å€¼+éŸ³æ•ˆæ›´æ–° â†’ UIåé¥‹

#### ğŸ“Š **éšæ®µ4: æ•¸å€¼è¨ˆç®—èˆ‡ç‹€æ…‹ç®¡ç†**

```csharp
// æ¯å€‹ç¯€æ‹å‘¨æœŸçµæŸæ™‚çš„æ•¸å€¼è¨ˆç®—æµç¨‹
void CalculateStimulationEffects()
{
    // 1. æ”¶é›†ç•¶å‰æ‰€æœ‰æ´»å‹•çš„èº«é«”éƒ¨ä½
    var activeBodyParts = GetActiveBodyParts();
    
    // 2. æ ¹æ“šå§¿å‹¢å’Œå‹•ä½œè¨ˆç®—åŸºç¤åˆºæ¿€å€¼
    foreach (var bodyPart in activeBodyParts)
    {
        float baseStimulation = GetBaseStimulation(bodyPart, currentAction);
        
        // 3. å¥—ç”¨å§¿å‹¢ç‰¹å®šçš„å€æ•¸
        float positionMultiplier = GetPositionMultiplier(currentPosition, bodyPart);
        
        // 4. å¥—ç”¨æ•æ„Ÿåº¦è¨ˆç®—
        float sensitivity = numericalRecords.CalculateSensitivity(bodyPart);
        
        // 5. è¨ˆç®—æœ€çµ‚åˆºæ¿€å€¼
        float finalStimulation = baseStimulation * positionMultiplier * sensitivity;
        
        // 6. åˆ†åˆ¥å½±éŸ¿é›™æ–¹çš„å¿«æ„Ÿå€¼
        numericalRecords.girlDelight += finalStimulation;
        numericalRecords.playerDelight += finalStimulation * 0.6f;
    }
    
    // 7. è¨ˆç®—é«”åŠ›æ¶ˆè€—
    float staminaCost = CalculateStaminaCost(activeBodyParts, intensity);
    numericalRecords.playerStamina -= staminaCost;
    numericalRecords.girlStamina -= staminaCost * 0.5f;
    
    // 8. æ›´æ–°æ•æ„Ÿåº¦åƒæ•¸ (åŸºæ–¼ç´¯ç©ç¶“é©—)
    UpdateSensitivityFactors();
}
```

**æ•¸æ“šæµå‹•**: å‹•ä½œç‹€æ…‹ â†’ åŸºç¤æ•¸å€¼è¨ˆç®— â†’ å§¿å‹¢ä¿®æ­£ â†’ æ•æ„Ÿåº¦èª¿æ•´ â†’ æœ€çµ‚æ•¸å€¼æ›´æ–°

#### ğŸ† **éšæ®µ5: é«˜æ½®æª¢æ¸¬èˆ‡ç‹€æ…‹è½‰æ›**

```csharp
// æ¯å€‹ç¯€æ‹å‘¨æœŸéƒ½æœƒåŸ·è¡Œçš„æª¢æ¸¬
void CheckGameEndingConditions()
{
    // 1. é«˜æ½®æª¢æ¸¬
    if (numericalRecords.playerDelight >= 100f)
    {
        TriggerPlayerOrgasm();
    }
    
    if (numericalRecords.girlDelight >= 100f)
    {
        TriggerGirlOrgasm();
    }
    
    // 2. é›™æ–¹é«˜æ½®æª¢æ¸¬
    if (playerDelight >= 100f && girlDelight >= 100f)
    {
        TriggerMutualOrgasm(); // æœ€ä½³çµå±€
    }
    
    // 3. é«”åŠ›è€—ç›¡æª¢æ¸¬
    if (numericalRecords.playerStamina <= 0f)
    {
        TriggerExhaustionEnding();
    }
    
    // 4. æ™‚é–“é™åˆ¶æª¢æ¸¬
    if (GetSessionDuration() >= maxSessionTime)
    {
        TriggerTimeoutEnding();
    }
}

void TriggerPlayerOrgasm()
{
    // 1. åœæ­¢æ‰€æœ‰ç¯€æ‹æ§åˆ¶å™¨
    rhythmController.StopRhythm();
    
    // 2. æ’­æ”¾é«˜æ½®å‹•ç•«å’ŒéŸ³æ•ˆ
    PlayOrgasmSequence(OrgasmType.Player);
    
    // 3. é–‹å§‹çµç®—æµç¨‹
    StartEndingSequence();
}
```

**æ•¸æ“šæµå‹•**: æ•¸å€¼æª¢æ¸¬ â†’ çµæŸæ¢ä»¶åˆ¤å®š â†’ åœæ­¢äº’å‹•ç³»çµ± â†’ æ’­æ”¾çµå±€å‹•ç•« â†’ é€²å…¥çµç®—

#### ğŸ’¾ **éšæ®µ6: çµç®—èˆ‡æ•¸æ“šä¿å­˜**

```csharp
// æœ€çµ‚çµç®—æµç¨‹
void StartEndingSequence()
{
    // 1. è¨ˆç®—æœ¬æ¬¡äº’å‹•çš„å„é …æ•¸æ“š
    var sessionData = new IntimacySessionData
    {
        sessionDuration = GetSessionDuration(),
        finalPlayerDelight = numericalRecords.playerDelight,
        finalGirlDelight = numericalRecords.girlDelight,
        playerSatisfaction = CalculatePlayerSatisfaction(),
        girlSatisfaction = CalculateGirlSatisfaction(),
        positionsUsed = GetUsedPositions(),
        totalActions = GetTotalActionCount(),
        newActionsUnlocked = GetNewActionsUnlocked(),
        endingType = GetEndingType()
    };
    
    // 2. è¨ˆç®—å°ä¸»éŠæˆ²çš„å½±éŸ¿
    float affectionGain = CalculateAffectionGain(sessionData);
    float energyLoss = CalculateEnergyLoss(sessionData);
    float timeSpent = sessionData.sessionDuration / 60f;
    
    // 3. æ›´æ–°ä¸»éŠæˆ²æ•¸æ“š
    IntimacyGameBridge.ApplyIntimacyResults(sessionData);
    
    // 4. ä¿å­˜äº’å‹•è¨˜éŒ„å’Œåå¥½æ•¸æ“š
    IntimacyPreferenceSystem.RecordSession(sessionData);
    IntimacySaveData.SaveToPlayerPrefs();
    
    // 5. é¡¯ç¤ºçµç®—ç•«é¢
    ShowEndingResults(sessionData);
    
    // 6. å›åˆ°ä¸»éŠæˆ²
    SceneManager.LoadScene("MainGame");
}
```

**æ•¸æ“šæµå‹•**: äº’å‹•æ•¸æ“šæ”¶é›† â†’ æ»¿æ„åº¦è¨ˆç®— â†’ ä¸»éŠæˆ²æ•¸å€¼å½±éŸ¿ â†’ åå¥½å­¸ç¿’æ›´æ–° â†’ å­˜æª”ä¿å­˜ â†’ è¿”å›ä¸»éŠæˆ²

### ğŸ”— **ç³»çµ±é–“äº¤äº’é—œä¿‚åœ–**

```
ç©å®¶è¼¸å…¥ (æŒ‰éˆ•/æ»‘æ¡¿)
    â†“
PlayerController (å„å§¿å‹¢å°ˆå±¬)
    â†“
RhythmController (ç¯€æ‹ç·©è¡)
    â†“
SpineManager (å‹•ç•«æ’­æ”¾) + NumericalRecords (æ•¸å€¼è¨ˆç®—) + UIManager (ç•Œé¢æ›´æ–°) + AudioManager (éŸ³æ•ˆ)
    â†“
ç‹€æ…‹æª¢æ¸¬ (é«˜æ½®/é«”åŠ›/æ™‚é–“)
    â†“
çµç®—ç³»çµ± (æ•¸æ“šçµ±è¨ˆ)
    â†“
ä¸»éŠæˆ²æ©‹æ¥ (å½±éŸ¿å¥½æ„Ÿåº¦/æ™‚é–“/é«”åŠ›)
    â†“
å­˜æª”ç³»çµ± (åå¥½å­¸ç¿’/é€²åº¦ä¿å­˜)
    â†“
è¿”å›ä¸»éŠæˆ²
```

### â±ï¸ **æ™‚é–“è»¸æµç¨‹**

```
T=0s     é€²å…¥æˆäººå…§å®¹æ¨¡å¼ï¼Œåˆå§‹åŒ–ç³»çµ±
T=0-1.5s ç¬¬1å€‹ç¯€æ‹å‘¨æœŸ (ç©å®¶å­¸ç¿’æ“ä½œ)
T=1.5s   ç¬¬1æ¬¡æ•¸å€¼æ›´æ–°å’Œå‹•ç•«åˆ‡æ›
T=1.5-3s ç¬¬2å€‹ç¯€æ‹å‘¨æœŸ (ç©å®¶ç†Ÿç·´æ“ä½œ)
T=3s     ç¬¬2æ¬¡æ•¸å€¼æ›´æ–°...
...
T=60-300s æŒçºŒäº’å‹•ï¼Œæ•¸å€¼é€æ¼¸ç´¯ç©
T=çµæŸ   è§¸ç™¼çµç®—æ¢ä»¶ï¼Œé€²å…¥çµç®—æµç¨‹
T=çµç®—+5s è¿”å›ä¸»éŠæˆ²ï¼Œæ•¸å€¼å½±éŸ¿ç”Ÿæ•ˆ
```

é€™å°±æ˜¯æ•´å€‹ç³»çµ±å¾ç©å®¶è¼¸å…¥åˆ°æœ€çµ‚çµç®—çš„å®Œæ•´æ•¸æ“šæµå‹•éç¨‹ï¼æ¯å€‹ç’°ç¯€éƒ½ç¢ºä¿äº†æ•¸æ“šçš„ä¸€è‡´æ€§å’ŒéŠæˆ²é«”é©—çš„æµæš¢æ€§ã€‚

---

## ğŸµ éŸ³æ•ˆèˆ‡èªéŸ³ç³»çµ±è¨­è¨ˆ

### ğŸ“‹ èªéŸ³JSONé…ç½®ç³»çµ±

ä½ èªªå¾—å¾ˆå°ï¼èªéŸ³è§¸ç™¼æ‡‰è©²ç”¨ç¨ç«‹çš„JSONç®¡ç†ï¼Œé¿å…ç¨‹å¼ç¢¼éæ–¼é¾å¤§ï¼š

#### ğŸ¯ æ ¹æ“šæ·«äº‚å€¼çš„å¤šéšæ®µèªéŸ³JSON

```
èªéŸ³æª”æ¡ˆçµæ§‹:
â”œâ”€â”€ SexyVoice_Slutty_0-20.json    (ä¿å®ˆéšæ®µ)
â”œâ”€â”€ SexyVoice_Slutty_21-50.json   (å®³ç¾éšæ®µ)  
â”œâ”€â”€ SexyVoice_Slutty_51-80.json   (ä¸»å‹•éšæ®µ)
â””â”€â”€ SexyVoice_Slutty_81-100.json  (æ·«äº‚éšæ®µ)
```

#### ğŸ¯ èªéŸ³é…ç½®JSONçµæ§‹ (ä»¥å®³ç¾éšæ®µç‚ºä¾‹)

```json
{
  "voiceConfig": {
    "characterName": "å¥³ä¸»è§’",
    "voiceVersion": "1.0",
    "sluttyRange": [21, 50],
    "stageName": "å®³ç¾éšæ®µ",
    "categories": {
      "positionVoices": {
        "normal": {
          "actionVoices": {
            "friction": {
              "conditions": [
                {
                  "intensity": "low",
                  "playerDelight": [0, 30],
                  "girlDelight": [0, 25],
                  "voiceOptions": [
                    {
                      "audioFile": "shy_normal_friction_low_01.wav",
                      "text": "å—¯...è¼•...è¼•ä¸€é»...",
                      "weight": 4,
                      "cooldown": 5.0
                    },
                    {
                      "audioFile": "shy_normal_friction_low_02.wav", 
                      "text": "é€™æ¨£...ä¸æœƒå¤ªå¥‡æ€ªå§...",
                      "weight": 3,
                      "cooldown": 3.0
                    },
                    {
                      "audioFile": "shy_normal_friction_low_03.wav", 
                      "text": "æˆ‘...æˆ‘é‚„ä¸å¤ªç¿’æ…£...",
                      "weight": 2,
                      "cooldown": 4.0
                    }
                  ]
                }
              ]
            }
          }
        }
      }
    }
  }
}
```

#### ğŸ“‹ ä¸åŒæ·«äº‚åº¦éšæ®µçš„èªéŸ³å°æ¯”

| æ·«äº‚åº¦ç¯„åœ | éšæ®µåç¨± | èªéŸ³ç‰¹è‰² | ç¯„ä¾‹å°è© |
|-----------|----------|----------|----------|
| **0-20** | ä¿å®ˆéšæ®µ | æŠ—æ‹’ã€ç·Šå¼µã€ä¸æƒ…é¡˜ | "ä¸è¦...é€™æ¨£ä¸å¥½..." "æˆ‘å€‘ä¸æ‡‰è©²..." |
| **21-50** | å®³ç¾éšæ®µ | ç¾æ¾€ã€çŒ¶è±«ã€å°è² | "å—¯...è¼•ä¸€é»..." "é€™æ¨£...ä¸æœƒå¤ªå¥‡æ€ªå§..." |
| **51-80** | ä¸»å‹•éšæ®µ | é…åˆã€äº«å—ã€æœ‰åæ‡‰ | "å—¯å—¯...å¥½èˆ’æœ..." "å¯ä»¥...å†ç”¨åŠ›ä¸€é»..." |
| **81-100** | æ·«äº‚éšæ®µ | ä¸»å‹•ã€æ¸´æ±‚ã€å¤§è†½ | "æ›´å¤š...é‚„è¦æ›´å¤š..." "ç”¨åŠ›...ä¸ç”¨æ†æƒœæˆ‘..." |

### ğŸ”„ å‹•æ…‹èªéŸ³è¼‰å…¥ç³»çµ±

```csharp
public class SexyVoiceManager : MonoBehaviour
{
    [Header("èªéŸ³é…ç½®æª”æ¡ˆ")]
    public TextAsset[] voiceConfigJsons; // 4å€‹ä¸åŒéšæ®µçš„JSON
    
    [Header("èªéŸ³æ§åˆ¶")]
    public float globalVolume = 1.0f;
    public bool enableVoice = true;
    
    private VoiceConfig currentVoiceConfig;
    private int currentSluttyStage = -1; // ç•¶å‰æ·«äº‚åº¦éšæ®µ
    private Dictionary<string, float> voiceCooldowns = new Dictionary<string, float>();
    private Dictionary<string, AudioClip> audioClipCache = new Dictionary<string, AudioClip>();
    
    // ğŸ“Š æ·«äº‚åº¦éšæ®µå°æ‡‰è¡¨
    private readonly Dictionary<int, string> stageFileMapping = new Dictionary<int, string>
    {
        { 0, "SexyVoice_Slutty_0-20" },      // ä¿å®ˆéšæ®µ
        { 1, "SexyVoice_Slutty_21-50" },     // å®³ç¾éšæ®µ  
        { 2, "SexyVoice_Slutty_51-80" },     // ä¸»å‹•éšæ®µ
        { 3, "SexyVoice_Slutty_81-100" }     // æ·«äº‚éšæ®µ
    };
    
    void Start()
    {
        InitializeVoiceSystem();
    }
    
    void Update()
    {
        // ğŸ”„ å±€å…§å³æ™‚åµæ¸¬æ·«äº‚å€¼è®ŠåŒ–
        CheckSluttyValueChange();
    }
    
    // ğŸ¯ åˆå§‹åŒ–èªéŸ³ç³»çµ±
    void InitializeVoiceSystem()
    {
        float currentSlutty = NumericalRecords_Sexy.Instance.slutty;
        int newStage = GetSluttyStage(currentSlutty);
        LoadVoiceConfigForStage(newStage);
    }
    
    // ğŸ” å±€å…§åµæ¸¬æ·«äº‚å€¼è®ŠåŒ–ä¸¦åˆ·æ–°
    void CheckSluttyValueChange()
    {
        float currentSlutty = NumericalRecords_Sexy.Instance.slutty;
        int newStage = GetSluttyStage(currentSlutty);
        
        // å¦‚æœæ·«äº‚åº¦éšæ®µæ”¹è®Šï¼Œç«‹å³åˆ‡æ›èªéŸ³é…ç½®
        if (newStage != currentSluttyStage)
        {
            Debug.Log($"æ·«äº‚åº¦éšæ®µè®ŠåŒ–: {currentSluttyStage} â†’ {newStage} (æ·«äº‚å€¼: {currentSlutty})");
            LoadVoiceConfigForStage(newStage);
            
            // å¯é¸: æ’­æ”¾éšæ®µè½‰æ›çš„ç‰¹æ®ŠèªéŸ³
            TriggerStageTransitionVoice(currentSluttyStage, newStage);
        }
    }
    
    // ğŸ“Š æ ¹æ“šæ·«äº‚å€¼è¨ˆç®—éšæ®µ
    int GetSluttyStage(float sluttyValue)
    {
        if (sluttyValue <= 20) return 0;      // ä¿å®ˆéšæ®µ
        else if (sluttyValue <= 50) return 1; // å®³ç¾éšæ®µ
        else if (sluttyValue <= 80) return 2; // ä¸»å‹•éšæ®µ
        else return 3;                         // æ·«äº‚éšæ®µ
    }
    
    // ğŸ”„ è¼‰å…¥æŒ‡å®šéšæ®µçš„èªéŸ³é…ç½®
    void LoadVoiceConfigForStage(int stage)
    {
        if (stage >= 0 && stage < voiceConfigJsons.Length && voiceConfigJsons[stage] != null)
        {
            currentVoiceConfig = JsonUtility.FromJson<VoiceConfig>(voiceConfigJsons[stage].text);
            currentSluttyStage = stage;
            
            // æ¸…ç†èˆŠçš„éŸ³é »ç·©å­˜ï¼Œè¼‰å…¥æ–°çš„
            ClearAudioCache();
            CacheAudioClipsForCurrentStage();
            
            Debug.Log($"èªéŸ³é…ç½®æ›´æ–°: {currentVoiceConfig.stageName} (æ·«äº‚åº¦: {currentVoiceConfig.sluttyRange[0]}-{currentVoiceConfig.sluttyRange[1]})");
        }
    }
    
    // ğŸµ éšæ®µè½‰æ›èªéŸ³
    void TriggerStageTransitionVoice(int fromStage, int toStage)
    {
        // æ’­æ”¾éšæ®µè½‰æ›çš„ç‰¹æ®ŠèªéŸ³
        var transitionContext = new VoiceTriggerContext
        {
            triggerType = VoiceTriggerType.StageTransition,
            fromStage = fromStage,
            toStage = toStage,
            playerDelight = NumericalRecords_Sexy.Instance.playerDelight,
            girlDelight = NumericalRecords_Sexy.Instance.girlDelight
        };
        
        TriggerVoice(transitionContext);
    }
    
    // ğŸµ ä¸»è¦èªéŸ³è§¸ç™¼æ–¹æ³• (ä¿æŒä¸è®Š)
    public void TriggerVoice(VoiceTriggerContext context)
    {
        if (!enableVoice || currentVoiceConfig == null) return;
        
        var voiceOptions = FindMatchingVoices(context);
        if (voiceOptions != null && voiceOptions.Count > 0)
        {
            var selectedVoice = SelectVoiceByWeight(voiceOptions);
            PlayVoice(selectedVoice);
        }
    }
    
    // ğŸ§¹ æ¸…ç†éŸ³é »ç·©å­˜
    void ClearAudioCache()
    {
        foreach (var clip in audioClipCache.Values)
        {
            if (clip != null)
            {
                Resources.UnloadAsset(clip);
            }
        }
        audioClipCache.Clear();
    }
    
    // ğŸ“¦ ç‚ºç•¶å‰éšæ®µç·©å­˜éŸ³é »
    void CacheAudioClipsForCurrentStage()
    {
        // æ ¹æ“šç•¶å‰èªéŸ³é…ç½®è¼‰å…¥å°æ‡‰çš„éŸ³é »æª”æ¡ˆ
        StartCoroutine(LoadAudioClipsAsync());
    }
    
    IEnumerator LoadAudioClipsAsync()
    {
        // é€™è£¡å¯¦ç¾éŸ³é »æª”æ¡ˆçš„ç•°æ­¥è¼‰å…¥
        // é¿å…éšæ®µåˆ‡æ›æ™‚é€ æˆå¡é “
        yield return null;
    }
}

// ğŸ¯ æ“´å±•èªéŸ³è§¸ç™¼ä¸Šä¸‹æ–‡
public class VoiceTriggerContext
{
    public VoiceTriggerType triggerType;
    public string position;          // "normal", "cowgirl", "doggystyle"
    public string actionType;        // "friction", "finger", "main"
    public string intensity;         // "low", "medium", "high"
    public float playerDelight;
    public float girlDelight;
    public string fromPosition;      // å§¿å‹¢åˆ‡æ›ç”¨
    public string toPosition;        // å§¿å‹¢åˆ‡æ›ç”¨
    public string endingType;        // çµå±€é¡å‹
    public int fromStage;            // éšæ®µè½‰æ›ç”¨
    public int toStage;              // éšæ®µè½‰æ›ç”¨
    public Dictionary<string, object> specialConditions; // ç‰¹æ®Šæ¢ä»¶
}

public enum VoiceTriggerType
{
    ActionVoice,        // å‹•ä½œèªéŸ³
    StateVoice,         // ç‹€æ…‹èªéŸ³
    ReactionVoice,      // åæ‡‰èªéŸ³
    StageTransition     // éšæ®µè½‰æ›èªéŸ³
```

### ğŸ¯ èªéŸ³ç³»çµ±é‹ä½œæµç¨‹

```
1. é€²å…¥æˆäººå…§å®¹æ¨¡å¼
   â†“
2. è®€å–ç•¶å‰æ·«äº‚å€¼ â†’ è¼‰å…¥å°æ‡‰JSON
   â†“  
3. éŠæˆ²é€²è¡Œä¸­å³æ™‚ç›£æ§æ·«äº‚å€¼è®ŠåŒ–
   â†“
4. æ·«äº‚å€¼è·¨éšæ®µ â†’ å‹•æ…‹åˆ‡æ›èªéŸ³JSON
   â†“
5. ç¯€æ‹è§¸ç™¼ â†’ æ ¹æ“šç•¶å‰JSONæ’­æ”¾å°æ‡‰èªéŸ³
```

**å„ªå‹¢**: èˆ‡é¤Šæˆå°è©±ç³»çµ±ä¸€è‡´çš„è¨­è¨ˆæ€è·¯ï¼Œç­–åŠƒå‹å¥½ï¼Œç¨‹å¼ç¢¼ä¹¾æ·¨ï¼

---

## ğŸ’° çµç®—ç³»çµ±èˆ‡æ•¸å€¼è¨ˆç®—

### ğŸ† çµç®—æµç¨‹è¨­è¨ˆ

```csharp
public class IntimacySettlementSystem : MonoBehaviour  
{
    [Header("çµç®—é…ç½®")]
    public AnimationCurve affectionGainCurve;       // å¥½æ„Ÿåº¦å¢ç›Šæ›²ç·š
    public AnimationCurve sluttyGainCurve;          // æ·«äº‚å€¼å¢ç›Šæ›²ç·š
    public float maxAffectionGain = 15f;            // å–®æ¬¡æœ€å¤§å¥½æ„Ÿåº¦å¢ç›Š
    public float maxSluttyGain = 10f;               // å–®æ¬¡æœ€å¤§æ·«äº‚å€¼å¢ç›Š
    
    // ğŸ† æœ€çµ‚çµç®—æ–¹æ³•
    public SettlementResult CalculateFinalSettlement(IntimacySessionData sessionData)
    {
        var result = new SettlementResult();
        
        // 1. åŸºç¤æ•¸å€¼è¨ˆç®—
        result.baseAffectionGain = CalculateBaseAffectionGain(sessionData);
        result.baseSluttyGain = CalculateBaseSluttyGain(sessionData);
        
        // 2. æ ¹æ“šéç¨‹è¡¨ç¾èª¿æ•´
        ApplyPerformanceModifiers(sessionData, result);
        
        // 3. æ ¹æ“šçµå±€é¡å‹èª¿æ•´
        ApplyEndingModifiers(sessionData, result);
        
        // 4. è¨ˆç®—å…¶ä»–å½±éŸ¿
        CalculateOtherEffects(sessionData, result);
        
        return result;
    }
    
    // ğŸ“Š åŸºç¤å¥½æ„Ÿåº¦è¨ˆç®—
    float CalculateBaseAffectionGain(IntimacySessionData sessionData)
    {
        // åŸºæ–¼é›™æ–¹æ»¿æ„åº¦çš„åŠ æ¬Šå¹³å‡
        float satisfaction = (sessionData.playerSatisfaction + sessionData.girlSatisfaction) / 2f;
        
        // ä½¿ç”¨æ›²ç·šä¾†èª¿æ•´å¢ç›Š (é¿å…ç·šæ€§å¢é•·)
        float curveValue = affectionGainCurve.Evaluate(satisfaction);
        
        return maxAffectionGain * curveValue;
    }
    
    // ğŸ’‹ åŸºç¤æ·«äº‚å€¼è¨ˆç®—  
    float CalculateBaseSluttyGain(IntimacySessionData sessionData)
    {
        // æ·«äº‚å€¼ä¸»è¦åŸºæ–¼äº’å‹•æ¿€çƒˆç¨‹åº¦å’ŒæŒçºŒæ™‚é–“
        float intensityFactor = CalculateIntensityFactor(sessionData);
        float durationFactor = Mathf.Clamp01(sessionData.sessionDuration / 300f); // 5åˆ†é˜ç‚ºåŸºæº–
        
        float baseGain = intensityFactor * durationFactor;
        float curveValue = sluttyGainCurve.Evaluate(baseGain);
        
        return maxSluttyGain * curveValue;
    }
    
    // âš¡ è¨ˆç®—äº’å‹•æ¿€çƒˆç¨‹åº¦
    float CalculateIntensityFactor(IntimacySessionData sessionData)
    {
        float intensityScore = 0f;
        
        // å§¿å‹¢å¤šæ¨£æ€§åŠ åˆ†
        intensityScore += sessionData.positionsUsed.Count * 0.2f;
        
        // å‹•ä½œé »ç‡åŠ åˆ†
        intensityScore += (sessionData.totalActions / sessionData.sessionDuration) * 0.1f;
        
        // é«˜æ½®é”æˆåŠ åˆ†  
        if (sessionData.endingType.Contains("mutual")) intensityScore += 0.5f;
        else if (sessionData.endingType.Contains("orgasm")) intensityScore += 0.3f;
        
        return Mathf.Clamp01(intensityScore);
    }
    
    // ğŸ­ æ ¹æ“šéç¨‹è¡¨ç¾èª¿æ•´
    void ApplyPerformanceModifiers(IntimacySessionData sessionData, SettlementResult result)
    {
        // ğŸŒŸ å®Œç¾é…åˆåŠ æˆ
        if (sessionData.playerSatisfaction > 0.8f && sessionData.girlSatisfaction > 0.8f)
        {
            result.performanceBonus = 1.5f;
            result.bonusReasons.Add("å®Œç¾é…åˆ");
        }
        
        // ğŸ¯ æŒä¹…åŠ›çå‹µ
        if (sessionData.sessionDuration > 600f) // è¶…é10åˆ†é˜
        {
            result.performanceBonus *= 1.2f;
            result.bonusReasons.Add("æŒä¹…è€åŠ›");
        }
        
        // ğŸ¨ æŠ€å·§å¤šæ¨£æ€§çå‹µ
        if (sessionData.newActionsUnlocked > 0)
        {
            result.performanceBonus *= (1f + sessionData.newActionsUnlocked * 0.1f);
            result.bonusReasons.Add($"è§£é–æ–°æŠ€å·§ x{sessionData.newActionsUnlocked}");
        }
        
        // ğŸ’” æ—©æ´©æ‡²ç½°
        if (sessionData.sessionDuration < 60f && sessionData.endingType.Contains("player"))
        {
            result.performancePenalty = 0.7f;
            result.penaltyReasons.Add("éæ—©çµæŸ");
        }
    }
    
    // ğŸ… æ ¹æ“šçµå±€é¡å‹èª¿æ•´
    void ApplyEndingModifiers(IntimacySessionData sessionData, SettlementResult result)
    {
        float endingMultiplier = sessionData.endingType switch
        {
            "mutual_orgasm" => 2.0f,      // é›™æ–¹é«˜æ½® - æœ€ä½³çµå±€
            "girl_orgasm" => 1.5f,        // å¥³æ–¹é«˜æ½® - å„ªç§€çµå±€  
            "player_orgasm" => 1.0f,      // ç©å®¶é«˜æ½® - æ™®é€šçµå±€
            "exhaustion" => 0.8f,         // é«”åŠ›è€—ç›¡ - ç•¥å·®çµå±€
            "timeout" => 0.6f,            // æ™‚é–“è¶…æ™‚ - è¼ƒå·®çµå±€
            _ => 1.0f
        };
        
        result.endingMultiplier = endingMultiplier;
        result.endingDescription = GetEndingDescription(sessionData.endingType);
    }
    
    // ğŸ¯ è¨ˆç®—å…¶ä»–éŠæˆ²å½±éŸ¿
    void CalculateOtherEffects(IntimacySessionData sessionData, SettlementResult result)
    {
        // é«”åŠ›æ¶ˆè€—è¨ˆç®—
        result.energyLoss = Mathf.Clamp(sessionData.sessionDuration / 60f * 5f, 5f, 25f);
        
        // æ™‚é–“æ¶ˆè€— (éŠæˆ²å…§æ™‚é–“)
        result.timeSpent = sessionData.sessionDuration / 60f; // åˆ†é˜è½‰æ›ç‚ºéŠæˆ²å°æ™‚
        
        // ç¶“é©—å€¼ç²å¾—
        result.experienceGain = CalculateExperienceGain(sessionData);
        
        // ç‰¹æ®Šæ•ˆæœ (å¿ƒæƒ…ã€ç‹€æ…‹ç­‰)
        result.moodEffect = CalculateMoodEffect(sessionData);
    }
}

// ğŸ“‹ çµç®—çµæœæ•¸æ“šçµæ§‹
[System.Serializable]
public class SettlementResult  
{
    [Header("åŸºç¤æ•¸å€¼")]
    public float baseAffectionGain;         // åŸºç¤å¥½æ„Ÿåº¦å¢ç›Š
    public float baseSluttyGain;            // åŸºç¤æ·«äº‚å€¼å¢ç›Š
    
    [Header("èª¿æ•´ä¿‚æ•¸")]
    public float performanceBonus = 1.0f;   // è¡¨ç¾åŠ æˆå€æ•¸
    public float performancePenalty = 1.0f; // è¡¨ç¾æ‡²ç½°å€æ•¸  
    public float endingMultiplier = 1.0f;   // çµå±€å€æ•¸
    
    [Header("æœ€çµ‚çµæœ")]
    public float finalAffectionGain => baseAffectionGain * performanceBonus * performancePenalty * endingMultiplier;
    public float finalSluttyGain => baseSluttyGain * performanceBonus * performancePenalty * endingMultiplier;
    
    [Header("å…¶ä»–å½±éŸ¿")]
    public float energyLoss;                // é«”åŠ›æ¶ˆè€—
    public float timeSpent;                 // æ™‚é–“æ¶ˆè€—
    public float experienceGain;            // ç¶“é©—å€¼ç²å¾—
    public string moodEffect;               // å¿ƒæƒ…å½±éŸ¿
    
    [Header("çµç®—è©³æƒ…")]
    public string endingDescription;        // çµå±€æè¿°
    public List<string> bonusReasons = new List<string>();    // åŠ åˆ†åŸå› 
    public List<string> penaltyReasons = new List<string>();  // æ‰£åˆ†åŸå› 
}
```

### ğŸ“Š çµç®—UIå±•ç¤º

```csharp
public class SettlementUIManager : MonoBehaviour
{
    [Header("UIçµ„ä»¶")]
    public Text endingTitleText;
    public Text affectionGainText;
    public Text sluttyGainText;
    public Text bonusDetailsText;
    public Slider affectionSlider;
    public Slider sluttySlider;
    
    // ğŸ¨ é¡¯ç¤ºçµç®—çµæœ
    public void ShowSettlementResults(SettlementResult result)
    {
        StartCoroutine(AnimateSettlementResults(result));
    }
    
    IEnumerator AnimateSettlementResults(SettlementResult result)
    {
        // 1. é¡¯ç¤ºçµå±€æ¨™é¡Œ
        endingTitleText.text = result.endingDescription;
        yield return new WaitForSeconds(1f);
        
        // 2. å‹•ç•«é¡¯ç¤ºå¥½æ„Ÿåº¦å¢åŠ 
        yield return AnimateValueIncrease(affectionSlider, result.finalAffectionGain, 
                                         affectionGainText, "å¥½æ„Ÿåº¦");
        
        // 3. å‹•ç•«é¡¯ç¤ºæ·«äº‚å€¼å¢åŠ   
        yield return AnimateValueIncrease(sluttySlider, result.finalSluttyGain,
                                         sluttyGainText, "æ·«äº‚å€¼");
        
        // 4. é¡¯ç¤ºåŠ åˆ†è©³æƒ…
        ShowBonusDetails(result);
        
        yield return new WaitForSeconds(2f);
        
        // 5. é¡¯ç¤ºè¿”å›æŒ‰éˆ•
        ShowReturnButton();
    }
    
    IEnumerator AnimateValueIncrease(Slider slider, float targetValue, Text displayText, string valueName)
    {
        float startValue = slider.value;
        float duration = 1.5f;
        float elapsed = 0f;
        
        while (elapsed < duration)
        {
            elapsed += Time.deltaTime;
            float currentValue = Mathf.Lerp(startValue, startValue + targetValue, elapsed / duration);
            slider.value = currentValue;
            displayText.text = $"{valueName} +{targetValue:F1}";
            yield return null;
        }
    }
}
```

### ğŸ¯ çµç®—ç³»çµ±ç‰¹é»

1. **åŸºæ–¼è¡¨ç¾çš„å‹•æ…‹èª¿æ•´** - ä¸æ˜¯å›ºå®šå¢ç›Šï¼Œè€Œæ˜¯æ ¹æ“šäº’å‹•å“è³ªèª¿æ•´
2. **å¤šå› å­è¨ˆç®—** - è€ƒæ…®æ»¿æ„åº¦ã€æŒçºŒæ™‚é–“ã€æŠ€å·§å¤šæ¨£æ€§ç­‰
3. **çµå±€å·®ç•°åŒ–** - ä¸åŒçµå±€æœ‰ä¸åŒçš„æ•¸å€¼å½±éŸ¿
4. **è¦–è¦ºåŒ–åé¥‹** - å‹•ç•«å±•ç¤ºæ•¸å€¼è®ŠåŒ–éç¨‹
5. **è©³ç´°èªªæ˜** - è®“ç©å®¶äº†è§£æ•¸å€¼è®ŠåŒ–çš„åŸå› 

é€™æ¨£çš„çµç®—ç³»çµ±æ—¢æœ‰æ·±åº¦åˆæœ‰è¶£å‘³æ€§ï¼

---

## ğŸ“ å®Œæ•´æ¶æ§‹ç¸½çµ

æˆäººå…§å®¹ç³»çµ±å·²å®ŒæˆæŠ€è¡“å¯¦ä½œåˆ†æï¼Œæ¶µè“‹æ‰€æœ‰æ ¸å¿ƒçµ„ä»¶ï¼š

### âœ… å·²å¯¦ç¾çš„æ ¸å¿ƒç³»çµ±
- **æ¨¡çµ„åŒ–æ¶æ§‹**: SexyGameManager + ä¸‰å¤§å§¿å‹¢ç®¡ç†å™¨ + å…±äº«ç³»çµ±
- **ç¯€æ‹åŒæ­¥å‹•ç•«**: è§£æ±ºå‹•ç•«æŠ½æå•é¡Œçš„å‰µæ–°è¨­è¨ˆ
- **ä¸‰å¤§å§¿å‹¢ç³»çµ±**: æ­£å¸¸ä½ã€å¥³ä¸Šä½ã€èƒŒå¾Œä½ï¼Œå„å…·ç‰¹è‰²
- **å¤šéšæ®µèªéŸ³ç³»çµ±**: æ ¹æ“šæ·«äº‚å€¼å‹•æ…‹è¼‰å…¥JSONé…ç½®  
- **æ•¸å€¼è¨ˆç®—ç³»çµ±**: è¤‡é›œçš„å¿«æ„Ÿå€¼ã€æ•æ„Ÿåº¦ã€é«”åŠ›è¨ˆç®—
- **çµç®—ç³»çµ±**: åŸºæ–¼è¡¨ç¾çš„å‹•æ…‹å¥½æ„Ÿåº¦å’Œæ·«äº‚å€¼å¢ç›Š

### ğŸ”§ æŠ€è¡“ç‰¹è‰²
- **åˆ†å±¤ç‹€æ…‹æ©Ÿè¨­è¨ˆ**: ä¸»ç‹€æ…‹æ§åˆ¶è¡Œç‚ºï¼Œå­ç‹€æ…‹æ§åˆ¶éƒ¨ä½
- **ç¯€æ‹ç·©è¡æ©Ÿåˆ¶**: é¡ä¼¼ä¼ºæœå™¨Tickçš„æ¦‚å¿µï¼Œä¿è­‰å‹•ä½œæµæš¢æ€§
- **å§¿å‹¢é–“æ•¸å€¼é€£çºŒæ€§**: åˆ‡æ›æ™‚ä¿æŒæ‰€æœ‰é€²åº¦ï¼Œç¢ºä¿é«”é©—é€£è²«
- **JSONé©…å‹•èªéŸ³ç³»çµ±**: ç­–åŠƒå‹å¥½ï¼Œæ”¯æ´RNGå’Œæ¢ä»¶åˆ¤æ–·
- **å¤šå› å­çµç®—ç®—æ³•**: è€ƒæ…®æ»¿æ„åº¦ã€æŒçºŒæ™‚é–“ã€æŠ€å·§ç­‰å¤šé‡å› ç´ 

### ğŸ“‹ å®Œæ•´åŠŸèƒ½è¦†è“‹
âœ… ç³»çµ±æ¶æ§‹è¨­è¨ˆ  
âœ… ä¸‰å¤§å§¿å‹¢å¯¦ç¾  
âœ… ç¯€æ‹å‹•ç•«æ§åˆ¶  
âœ… æ•¸å€¼è¨ˆç®—ç³»çµ±  
âœ… UIæ§åˆ¶ç³»çµ±  
âœ… éŸ³æ•ˆèªéŸ³ç³»çµ±  
âœ… çµç®—èˆ‡å›é¥‹ç³»çµ±  
âœ… ä¸»éŠæˆ²æ•´åˆæ©Ÿåˆ¶  

é€™æ˜¯ä¸€å€‹æŠ€è¡“å«é‡å¾ˆé«˜ä¸”é«”é©—å„ªç§€çš„æˆäººå…§å®¹ç³»çµ±è¨­è¨ˆï¼

---
            }
          ]
        }
      },
      "reactionVoices": {
        "position_switch": {
          "conditions": [
            {
              "fromPosition": "normal",
              "toPosition": "cowgirl",
              "voiceOptions": [
                {
                  "audioFile": "switch_to_cowgirl_01.wav",
                  "text": "æ›...æ›å€‹å§¿å‹¢...",
                  "weight": 3,
                  "cooldown": 5.0
                }
              ]
            }
          ]
        }
      }
    }
  }
}
```

#### ğŸ¯ èªéŸ³ç®¡ç†ç³»çµ±

```csharp
public class SexyVoiceManager : MonoBehaviour
{
    [Header("èªéŸ³é…ç½®")]
    public TextAsset voiceConfigJson;
    public AudioSource voiceAudioSource;
    
    [Header("èªéŸ³æ§åˆ¶")]
    public float globalVolume = 1.0f;
    public bool enableVoice = true;
    
    private VoiceConfig voiceConfig;
    private Dictionary<string, float> voiceCooldowns = new Dictionary<string, float>();
    private Dictionary<string, AudioClip> audioClipCache = new Dictionary<string, AudioClip>();
    
    void Start()
    {
        LoadVoiceConfig();
        CacheAudioClips();
    }
    
    void LoadVoiceConfig()
    {
        if (voiceConfigJson != null)
        {
            voiceConfig = JsonUtility.FromJson<VoiceConfig>(voiceConfigJson.text);
            Debug.Log($"èªéŸ³é…ç½®è¼‰å…¥å®Œæˆ: {voiceConfig.characterName}");
        }
    }
    
    // ğŸµ ä¸»è¦èªéŸ³è§¸ç™¼æ–¹æ³•
    public void TriggerVoice(VoiceTriggerContext context)
    {
        if (!enableVoice) return;
        
        var voiceOptions = FindMatchingVoices(context);
        if (voiceOptions != null && voiceOptions.Count > 0)
        {
            var selectedVoice = SelectVoiceByWeight(voiceOptions);
            PlayVoice(selectedVoice);
        }
    }
    
    // ğŸ¯ æ ¹æ“šæ¢ä»¶æ‰¾åˆ°ç¬¦åˆçš„èªéŸ³é¸é …
    List<VoiceOption> FindMatchingVoices(VoiceTriggerContext context)
    {
        // æ ¹æ“šcontextçš„é¡å‹å’Œæ¢ä»¶æœå°‹JSONé…ç½®
        switch (context.triggerType)
        {
            case VoiceTriggerType.ActionVoice:
                return FindActionVoices(context);
            case VoiceTriggerType.StateVoice:
                return FindStateVoices(context);
            case VoiceTriggerType.ReactionVoice:
                return FindReactionVoices(context);
        }
        return null;
    }
    
    List<VoiceOption> FindActionVoices(VoiceTriggerContext context)
    {
        var positionVoices = voiceConfig.categories.positionVoices[context.position];
        var actionVoices = positionVoices.actionVoices[context.actionType];
        
        foreach (var condition in actionVoices.conditions)
        {
            if (CheckConditions(condition, context))
            {
                // éæ¿¾å†·å»ä¸­çš„èªéŸ³
                return condition.voiceOptions.Where(v => !IsVoiceOnCooldown(v.audioFile)).ToList();
            }
        }
        return null;
    }
    
    // ğŸ² æ¬Šé‡å¼RNGé¸æ“‡
    VoiceOption SelectVoiceByWeight(List<VoiceOption> options)
    {
        int totalWeight = options.Sum(v => v.weight);
        int randomValue = UnityEngine.Random.Range(0, totalWeight);
        
        int currentWeight = 0;
        foreach (var option in options)
        {
            currentWeight += option.weight;
            if (randomValue < currentWeight)
            {
                return option;
            }
        }
        
        return options.First(); // å‚™ç”¨é¸é …
    }
    
    // ğŸ”Š æ’­æ”¾èªéŸ³
    void PlayVoice(VoiceOption voiceOption)
    {
        if (audioClipCache.TryGetValue(voiceOption.audioFile, out AudioClip clip))
        {
            voiceAudioSource.PlayOneShot(clip, globalVolume);
            
            // è¨­å®šå†·å»æ™‚é–“
            voiceCooldowns[voiceOption.audioFile] = Time.time + voiceOption.cooldown;
            
            // é¡¯ç¤ºå­—å¹• (å¦‚æœæœ‰UIç³»çµ±)
            if (!string.IsNullOrEmpty(voiceOption.text))
            {
                UIManager.ShowSubtitle(voiceOption.text, clip.length);
            }
            
            Debug.Log($"æ’­æ”¾èªéŸ³: {voiceOption.audioFile} - {voiceOption.text}");
        }
    }
    
    // â° æª¢æŸ¥èªéŸ³æ˜¯å¦åœ¨å†·å»ä¸­
    bool IsVoiceOnCooldown(string audioFile)
    {
        if (voiceCooldowns.TryGetValue(audioFile, out float cooldownEnd))
        {
            return Time.time < cooldownEnd;
        }
        return false;
    }
}

// ğŸ¯ èªéŸ³è§¸ç™¼ä¸Šä¸‹æ–‡
public class VoiceTriggerContext
{
    public VoiceTriggerType triggerType;
    public string position;          // "normal", "cowgirl", "doggystyle"
    public string actionType;        // "friction", "finger", "main"
    public string intensity;         // "low", "medium", "high"
    public float playerDelight;
    public float girlDelight;
    public string fromPosition;      // å§¿å‹¢åˆ‡æ›ç”¨
    public string toPosition;        // å§¿å‹¢åˆ‡æ›ç”¨
    public string endingType;        // çµå±€é¡å‹
    public Dictionary<string, object> specialConditions; // ç‰¹æ®Šæ¢ä»¶
}

public enum VoiceTriggerType
{
    ActionVoice,    // å‹•ä½œèªéŸ³
    StateVoice,     // ç‹€æ…‹èªéŸ³
    ReactionVoice   // åæ‡‰èªéŸ³
}
```

#### ğŸ® æ•´åˆåˆ°ç¯€æ‹ç³»çµ±

```csharp
// åœ¨ç¯€æ‹æ§åˆ¶å™¨ä¸­æ•´åˆèªéŸ³è§¸ç™¼
public class RhythmicAnimationController : MonoBehaviour
{
    [Header("èªéŸ³ç³»çµ±")]
    public SexyVoiceManager voiceManager;
    
    void OnBeatComplete()
    {
        // åŸæœ‰çš„è™•ç†...
        ApplyStateTransitions();
        CalculateStimulationEffects();
        
        // æ–°å¢: è§¸ç™¼èªéŸ³
        TriggerActionVoices();
        
        // æª¢æŸ¥ç‹€æ…‹èªéŸ³
        CheckStateVoices();
    }
    
    void TriggerActionVoices()
    {
        foreach (var kvp in targetStates)
        {
            var context = new VoiceTriggerContext
            {
                triggerType = VoiceTriggerType.ActionVoice,
                position = GetCurrentPosition(),
                actionType = kvp.Value.actionType.ToString().ToLower(),
                intensity = GetIntensityLevel(kvp.Value.intensity),
                playerDelight = numericalRecords.playerDelight,
                girlDelight = numericalRecords.girlDelight
            };
            
            voiceManager.TriggerVoice(context);
        }
    }
}
```

### ğŸ¯ èªéŸ³ç³»çµ±çš„å„ªå‹¢

1. **JSONé…ç½®** - ç­–åŠƒå¯ç›´æ¥ç·¨è¼¯ï¼Œä¸éœ€ç¨‹å¼ä»‹å…¥
2. **æ¬Šé‡å¼RNG** - å¯æ§åˆ¶èªéŸ³å‡ºç¾æ©Ÿç‡
3. **å†·å»æ©Ÿåˆ¶** - é¿å…èªéŸ³é‡è¤‡éæ–¼é »ç¹
4. **æ¢ä»¶åˆ¤æ–·** - æ”¯æ´è¤‡é›œçš„è§¸ç™¼æ¢ä»¶
5. **å¯æ“´å±•æ€§** - è¼•é¬†æ–°å¢æ–°èªéŸ³å’Œæ¢ä»¶

é€™æ¨£è¨­è¨ˆè®“èªéŸ³ç³»çµ±è®Šå¾—éå¸¸éˆæ´»ä¸”æ˜“æ–¼ç¶­è­·ï¼

---

## ğŸ“ å®Œæ•´æ¶æ§‹ç¸½çµ

æˆäººå…§å®¹ç³»çµ±å·²å®ŒæˆæŠ€è¡“å¯¦ä½œåˆ†æï¼Œæ¶µè“‹æ‰€æœ‰æ ¸å¿ƒçµ„ä»¶ï¼š

### âœ… å·²å¯¦ç¾çš„æ ¸å¿ƒç³»çµ±
- **ç‹€æ…‹æ©Ÿæ¶æ§‹**: PlayerActor_Sexy ä¸»æ§åˆ¶å™¨ + å„éƒ¨ä½å­ç‹€æ…‹æ©Ÿ
- **èº«é«”éƒ¨ä½æ§åˆ¶**: SexyCtrl_Chests, SexyCtrl_Hand, SexyCtrl_Body, Sexyctrl_GirlHand
- **æ•¸å€¼è¨ˆç®—ç³»çµ±**: NumericalRecords_Sexy è™•ç†å¿«æ„Ÿå€¼ã€é«”åŠ›å€¼ã€æ•æ„Ÿåº¦è¨ˆç®—
- **UIæ§åˆ¶ç³»çµ±**: SexyUIManager å‹•æ…‹ç®¡ç†æŒ‰éˆ•å¯ç”¨æ€§å’Œæ•¸å€¼é¡¯ç¤º
- **å‹•ç•«å”èª¿ç³»çµ±**: PlayerAnimatorManager è² è²¬å¤šéƒ¨ä½å‹•ç•«åŒæ­¥
- **éŠæˆ²æµç¨‹ç®¡ç†**: GamePlayManager_Sexy æ§åˆ¶æ•´é«”éŠæˆ²å¾ªç’°

### ğŸ”§ æŠ€è¡“ç‰¹è‰²
- **åˆ†å±¤ç‹€æ…‹æ©Ÿè¨­è¨ˆ**: ä¸»ç‹€æ…‹æ§åˆ¶è¡Œç‚ºæ¨¡å¼ï¼Œå­ç‹€æ…‹æ§åˆ¶å…·é«”éƒ¨ä½
- **å¤šéƒ¨ä½å”èª¿æ©Ÿåˆ¶**: æ”¯æ´åŒæ™‚æ§åˆ¶é ­éƒ¨ã€èƒ¸éƒ¨ã€æ‰‹éƒ¨ã€èº«é«”çš„è¤‡é›œäº’å‹•
- **å‹•æ…‹æ•¸å€¼ç³»çµ±**: åŸºæ–¼æ•æ„Ÿåº¦ã€é«”åŠ›ã€å¿«æ„Ÿçš„å¯¦æ™‚è¨ˆç®—èˆ‡åé¥‹
- **æ™ºèƒ½è¡çªè™•ç†**: è‡ªå‹•ç®¡ç†ä¸åˆç†çš„å‹•ä½œçµ„åˆ

---
### ğŸ› ï¸ æŠ€è¡“å¯¦ç¾è¦é»

- **æ€§èƒ½å„ªåŒ–**: ç‹€æ…‹æ©Ÿåˆ‡æ›é »ç¹ï¼Œéœ€æ³¨æ„GCå„ªåŒ–
- **è¨˜æ†¶é«”ç®¡ç†**: å¤§é‡å‹•ç•«è³‡æºéœ€è¦é©ç•¶çš„é è¼‰å’Œé‡‹æ”¾
- **æ•¸æ“šæŒä¹…åŒ–**: ä½¿ç”¨åŠ å¯†å­˜å„²æ•æ„Ÿçš„é€²åº¦æ•¸æ“š
- **å…¼å®¹æ€§**: ç¢ºä¿åœ¨ä¸åŒè¨­å‚™å’Œå¹³å°ä¸Šçš„ä¸€è‡´é«”é©—
- **æ¸¬è©¦è¦†è“‹**: éœ€è¦å…¨é¢çš„ç‹€æ…‹è½‰æ›å’Œé‚Šç•Œæ¢ä»¶æ¸¬è©¦

### ğŸ“š ç›¸é—œæ–‡æª”åƒè€ƒ

- `Architecture/CoreSystems/åŠ‡æƒ…æ’­æ”¾ç³»çµ±æ¶æ§‹.md` - äº†è§£å°è©±ç³»çµ±æ•´åˆ
- `Architecture/SharedSystems/å°è©±ç³»çµ±æ¶æ§‹.md` - äº†è§£äº‹ä»¶å»£æ’­æ©Ÿåˆ¶
- `GameMechanics/` - å…¶ä»–éŠæˆ²æ©Ÿåˆ¶çš„å¯¦ç¾åƒè€ƒ